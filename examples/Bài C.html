<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Điền Từ (Dạng Ô Chữ Đơn Giản)</title>
    <!-- Bootstrap 5 CSS for responsive design and components -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Google Fonts for 'Open Sans' typography -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons (e.g., check/times circles) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* General body styling */
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f2f5;
            line-height: 1.6;
            color: #333;
            padding-top: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        /* Main container for the exercise */
        .container-main {
            max-width: 900px;
            margin-top: 40px;
            margin-bottom: 40px;
            background-color: #ffffff;
            padding: 35px 45px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Headings */
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
        }
        h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600;
        }

        /* Instruction section styling */
        .instruction {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #555;
            text-align: center;
            line-height: 1.5;
            background-color: #e8f5e9;
            border-left: 6px solid #4CAF50;
            padding: 20px 25px;
            border-radius: 10px;
            color: #388e3c;
        }

        /* Styling for each exercise question */
        .question-item {
            margin-bottom: 30px; /* Increased margin for better separation */
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background-color: #fdfdfd;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        .question-item .question-text {
            font-size: 1.1em;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 15px;
            display: flex;
            align-items: center; /* Align content */
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            gap: 5px; /* Space between words */
        }

        /* Styling for input fields */
        .question-item .question-text input[type="text"] {
            display: inline-block;
            width: 150px; /* Adjust width as needed */
            margin: 0 5px;
            padding: 0 5px; /* Reduced padding for underline effect */
            border: none; /* Remove all borders */
            border-bottom: 1px solid #ced4da; /* Only bottom border */
            border-radius: 0; /* Remove border-radius for a clean underline */
            font-size: 1em;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: transparent; /* Ensure background is transparent */
            text-align: center; /* Center the text in the input */
        }
        .question-item .question-text input[type="text"]:focus {
            border-color: #80bdff;
            outline: 0;
            box-shadow: none; /* Remove box-shadow on focus for underline effect */
            border-bottom-width: 2px; /* Thicker underline on focus */
        }
        /* Styles for correct and incorrect input feedback */
        .question-item .question-text input[type="text"].is-correct {
            border-color: #198754;
            box-shadow: none; /* Remove box-shadow */
            border-bottom-width: 2px; /* Thicker underline for correct */
        }
        .question-item .question-text input[type="text"].is-incorrect {
            border-color: #dc3545;
            box-shadow: none; /* Remove box-shadow */
            border-bottom-width: 2px; /* Thicker underline for incorrect */
        }

        /* Feedback icons */
        .feedback-icon {
            margin-left: 10px;
            font-size: 1.2em;
            display: none; /* Hidden by default, shown by JS */
            vertical-align: middle;
        }
        .feedback-icon.text-success { color: #198754; }
        .feedback-icon.text-danger { color: #dc3545; }

        /* Buttons styling */
        .buttons .btn {
            padding: 12px 30px;
            font-size: 1.1em;
            margin: 0 15px;
            border-radius: 30px; /* Pill-shaped buttons */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .buttons .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        /* Score display styling */
        .score-display {
            font-size: 1.3em;
            font-weight: 700;
            color: #007bff;
            margin-top: 30px;
            margin-bottom: 25px;
            text-align: center;
            padding: 10px 20px;
            border-radius: 8px;
            background-color: #e6f7ff;
            border: 1px solid #b3e0ff;
            display: none; /* Hidden by default */
        }
        /* Score display color coding */
        .score-display.text-success { background-color: #d1e7dd; border-color: #a3cfb4; color: #198754; }
        .score-display.text-warning { background-color: #fff3cd; border-color: #ffeeba; color: #ffc107; }
        .score-display.text-danger { background-color: #f8d7da; border-color: #f5c2c7; color: #dc3545; }

        /* Detailed solution section styling */
        .solution-section {
            margin-top: 40px;
            padding-top: 25px;
            border-top: 1px dashed #ced4da;
            display: none; /* Hidden by default */
        }
        .solution-section h2 {
            color: #007bff;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
        }
        .solution-list .solution-item {
            margin-bottom: 20px;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-left: 5px solid #007bff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .solution-list .solution-item .question-text-solution {
            font-weight: 600;
            color: #34495e;
            margin-bottom: 8px;
        }
        .solution-list .solution-item .correct-answer-text {
            font-weight: 700;
            color: #198754;
            text-decoration: underline;
            margin-right: 5px;
        }
        .solution-list .solution-item .grammar-explanation {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
            background-color: #e9ecef;
            padding: 8px 12px;
            border-radius: 5px;
            border-left: 3px solid #6c757d;
        }
        .solution-list .solution-item .translation {
            font-style: italic;
            color: #6c757d;
            font-size: 0.95em;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #e0e0e0;
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 768px) {
            .container-main {
                padding: 25px;
                margin: 20px auto;
            }
            h1 {
                font-size: 1.8em;
            }
            h2 {
                font-size: 1.5em;
            }
            .instruction {
                font-size: 0.95em;
                padding: 15px;
            }
            .question-item {
                padding: 15px;
                margin-bottom: 20px;
            }
            .question-item .question-text {
                font-size: 1em;
                margin-bottom: 10px;
            }
            .question-item .question-text input[type="text"] {
                width: 100px; /* Smaller width for inputs on small screens */
                margin: 0 3px;
                padding: 0 4px; /* Adjusted padding */
            }
            .buttons .btn {
                font-size: 1.1em;
                padding: 10px 25px;
                margin: 0 8px;
            }
            .score-display {
                font-size: 1.3em;
                padding: 12px;
            }
            .solution-list .solution-item {
                padding: 10px 15px;
            }
            .solution-list .solution-item .grammar-explanation,
            .solution-list .solution-item .translation {
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <div class="container container-main">
        <div class="d-flex align-items-center justify-content-center mb-4">
            <h1>Bài Tập Điền Từ</h1>
        </div>
        <h2>Hoàn thành các câu sau.</h2>
        <p class="instruction">
            <strong>Instructions:</strong> Complete the sentences.
            <br>
            <strong>Hướng dẫn:</strong> Điền từ thích hợp vào chỗ trống.
            <br>
            <span class="text-muted">(Lưu ý: Đáp án và lời giải chi tiết sẽ hiển thị sau khi bạn nhấn "Kiểm tra".)</span>
        </p>

        <form id="fillInForm">
            <!-- Questions -->
            <div class="question-item">
                <p class="question-text">2. I want you to <input type="text" id="q2" name="q2" class="form-control d-inline-block w-auto"> Unit 6 at the weekend because you've got a test on Monday. (6)</p>
                <i class="feedback-icon fa-solid" id="icon2"></i>
            </div>

            <div class="question-item">
                <p class="question-text">4. Another word for 'clever' is '<input type="text" id="q4" name="q4" class="form-control d-inline-block w-auto">'. (5)</p>
                <i class="feedback-icon fa-solid" id="icon4"></i>
            </div>

            <div class="question-item">
                <p class="question-text">6. What's your favourite <input type="text" id="q6" name="q6" class="form-control d-inline-block w-auto"> at school? (7)</p>
                <i class="feedback-icon fa-solid" id="icon6"></i>
            </div>

            <div class="question-item">
                <p class="question-text">8. The other students were talking and laughing but Jamie <input type="text" id="q8" name="q8" class="form-control d-inline-block w-auto"> on his work. (12)</p>
                <i class="feedback-icon fa-solid" id="icon8"></i>
            </div>

            <div class="question-item">
                <p class="question-text">1. If you can do maths problems in your head, then you're good at <input type="text" id="q1" name="q1" class="form-control d-inline-block w-auto"> arithmetic. (6)</p>
                <i class="feedback-icon fa-solid" id="icon1"></i>
            </div>

            <div class="question-item">
                <p class="question-text">3. I got a <input type="text" id="q3" name="q3" class="form-control d-inline-block w-auto"> of nineteen out of twenty in the test. (4)</p>
                <i class="feedback-icon fa-solid" id="icon3"></i>
            </div>

            <div class="question-item">
                <p class="question-text">4. I'll have to <input type="text" id="q4_down" name="q4_down" class="form-control d-inline-block w-auto"> for that book because I've no idea where it is. (6)</p>
                <i class="feedback-icon fa-solid" id="icon4_down"></i>
            </div>

            <div class="question-item">
                <p class="question-text">5. Kelly didn't know what to say so she <input type="text" id="q5" name="q5" class="form-control d-inline-block w-auto"> before she answered. (9)</p>
                <i class="feedback-icon fa-solid" id="icon5"></i>
            </div>

            <div class="question-item">
                <p class="question-text">7. Everyone uses their <input type="text" id="q7" name="q7" class="form-control d-inline-block w-auto"> when they think. (5)</p>
                <i class="feedback-icon fa-solid" id="icon7"></i>
            </div>

            <div class="buttons text-center mt-5">
                <button type="button" class="btn btn-primary me-3" onclick="submitAnswers()">Kiểm tra</button>
                <button type="button" class="btn btn-secondary" onclick="resetExercise()">Làm lại</button>
            </div>
        </form>

        <div id="scoreDisplay" class="score-display mt-4"></div>

        <div class="solution-section" id="detailedSolution">
            <h2>Lời giải chi tiết và Giải thích</h2>
            <div class="solution-list">
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JavaScript bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        // Define correct answers, full sentences, explanations, and translations for each question.
        const questionsData = {
            'q2': { // Renamed from q2_across
                text_parts: ['I want you to ', ' Unit 6 at the weekend because you\'ve got a test on Monday. (6)'],
                correct_answer: 'revise',
                fullSentence: 'I want you to revise Unit 6 at the weekend because you\'ve got a test on Monday.',
                translation: 'Tôi muốn bạn ôn tập Unit 6 vào cuối tuần vì bạn có bài kiểm tra vào thứ Hai.',
                explanation: '"Revise" (ôn tập) có nghĩa là học lại những gì đã học để chuẩn bị cho một kỳ thi hoặc bài kiểm tra. Ngữ cảnh "test on Monday" gợi ý việc ôn tập.',
                grammar_note: 'Động từ "revise" thường đi với môn học hoặc đơn vị học tập.'
            },
            'q4': { // Renamed from q4_across
                text_parts: ['Another word for \'clever\' is \'', '\'. (5)'],
                correct_answer: 'smart',
                fullSentence: 'Another word for \'clever\' is \'smart\'.',
                translation: 'Một từ khác của \'clever\' là \'smart\'.',
                explanation: '"Smart" (thông minh, lanh lợi) là một từ đồng nghĩa với "clever".',
                grammar_note: 'Tính từ "smart" và "clever" đều chỉ sự thông minh.'
            },
            'q6': { // Renamed from q6_across
                text_parts: ['What\'s your favourite ', ' at school? (7)'],
                correct_answer: 'subject',
                fullSentence: 'What\'s your favourite subject at school?',
                translation: 'Môn học yêu thích của bạn ở trường là gì?',
                explanation: '"Subject" (môn học) là từ phù hợp nhất để hỏi về môn học yêu thích ở trường.',
                grammar_note: '"Subject" là danh từ chỉ môn học trong chương trình giáo dục.'
            },
            'q8': { // Renamed from q8_across
                text_parts: ['The other students were talking and laughing but Jamie ', ' on his work. (12)'],
                correct_answer: 'concentrated',
                fullSentence: 'The other students were talking and laughing but Jamie concentrated on his work.',
                translation: 'Các học sinh khác đang nói chuyện và cười đùa nhưng Jamie đã tập trung vào công việc của mình.',
                explanation: '"Concentrated" (tập trung) có nghĩa là dành toàn bộ sự chú ý vào một việc gì đó. Ngữ cảnh Jamie không bị phân tâm bởi tiếng ồn cho thấy sự tập trung.',
                grammar_note: 'Cấu trúc: "concentrate on something" (tập trung vào cái gì).'
            },
            'q1': { // Renamed from q1_down
                text_parts: ['If you can do maths problems in your head, then you\'re good at ', ' arithmetic. (6)'],
                correct_answer: 'mental',
                fullSentence: 'If you can do maths problems in your head, then you\'re good at mental arithmetic.',
                translation: 'Nếu bạn có thể giải các bài toán trong đầu, thì bạn giỏi tính nhẩm.',
                explanation: '"Mental arithmetic" (tính nhẩm) là khả năng thực hiện các phép tính toán trong đầu mà không cần dùng giấy bút hoặc máy tính. "Mental" (thuộc về tinh thần/tư duy) là tính từ phù hợp.',
                grammar_note: 'Cụm từ cố định: "mental arithmetic".'
            },
            'q3': { // Renamed from q3_down
                text_parts: ['I got a ', ' of nineteen out of twenty in the test. (4)'],
                correct_answer: 'mark',
                fullSentence: 'I got a mark of nineteen out of twenty in the test.',
                translation: 'Tôi đã đạt được điểm mười chín trên hai mươi trong bài kiểm tra.',
                explanation: '"Mark" (điểm số) là số điểm bạn nhận được trong một bài kiểm tra hoặc bài tập. Ngữ cảnh "nineteen out of twenty in the test" gợi ý đây là một điểm số.',
                grammar_note: '"Mark" là danh từ để chỉ điểm số, kết quả bài kiểm tra.'
            },
            'q4_down': { // Kept as q4_down to avoid conflict with q4 (smart)
                text_parts: ['I\'ll have to ', ' for that book because I\'ve no idea where it is. (6)'],
                correct_answer: 'search',
                fullSentence: 'I\'ll have to search for that book because I\'ve no idea where it is.',
                translation: 'Tôi sẽ phải tìm kiếm cuốn sách đó vì tôi không biết nó ở đâu.',
                explanation: '"Search" (tìm kiếm) có nghĩa là cố gắng tìm thấy thứ gì đó. Ngữ cảnh "no idea where it is" gợi ý hành động tìm kiếm.',
                grammar_note: 'Cấu trúc: "search for something" (tìm kiếm cái gì).'
            },
            'q5': { // Renamed from q5_down
                text_parts: ['Kelly didn\'t know what to say so she ', ' before she answered. (9)'],
                correct_answer: 'hesitated',
                fullSentence: 'Kelly didn\'t know what to say so she hesitated before she answered.',
                translation: 'Kelly không biết phải nói gì nên cô ấy đã do dự trước khi trả lời.',
                explanation: '"Hesitated" (do dự) có nghĩa là tạm dừng hoặc không chắc chắn trước khi làm hoặc nói điều gì đó. Ngữ cảnh "didn\'t know what to say" và "before she answered" rất phù hợp.',
                grammar_note: 'Động từ "hesitate" thường đi với "to do something" hoặc "before doing something".'
            },
            'q7': { // Renamed from q7_down
                text_parts: ['Everyone uses their ', ' when they think. (5)'],
                correct_answer: 'brain',
                fullSentence: 'Everyone uses their brain when they think.',
                translation: 'Mọi người đều sử dụng bộ não của mình khi họ suy nghĩ.',
                explanation: '"Brain" (bộ não) là cơ quan trong đầu dùng để suy nghĩ. Ngữ cảnh "when they think" trực tiếp liên quan đến chức năng của bộ não.',
                grammar_note: '"Brain" là danh từ chỉ bộ não, trung tâm của tư duy.'
            }
        };

        // Store user answers (though not strictly necessary for this simplified version, good practice)
        const userAnswers = {};

        /**
         * Handles input events to update the userAnswers object.
         * @param {Event} event The input event.
         */
        function handleInput(event) {
            const inputId = event.target.id;
            userAnswers[inputId] = event.target.value.trim();
        }

        // Add event listeners to all input fields
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.question-text input[type="text"]').forEach(input => {
                input.addEventListener('input', handleInput);
            });
        });

        /**
         * Submits the user's answers, calculates the score, provides feedback,
         * and displays detailed solutions.
         */
        function submitAnswers() {
            let score = 0;
            const totalQuestions = Object.keys(questionsData).length;

            const solutionListDiv = document.querySelector('#detailedSolution .solution-list');
            solutionListDiv.innerHTML = ''; // Clear previous solutions
            document.getElementById('detailedSolution').style.display = 'block'; // Show solution section

            // Iterate through each question
            Object.keys(questionsData).forEach(qId => {
                const questionInfo = questionsData[qId];
                const inputElement = document.getElementById(qId);
                const feedbackIcon = document.getElementById(`icon${qId.substring(1)}`); // Adjusted ID for icons

                let isCorrect = false;
                const userAnswer = (inputElement ? inputElement.value.trim() : '').toLowerCase();
                const correctAnswer = questionInfo.correct_answer.toLowerCase();

                // Reset feedback classes on input
                if (inputElement) {
                    inputElement.classList.remove('is-correct', 'is-incorrect');
                }

                if (userAnswer === correctAnswer) {
                    isCorrect = true;
                    score++;
                    if (inputElement) {
                        inputElement.classList.add('is-correct');
                    }
                } else {
                    if (inputElement) {
                        inputElement.classList.add('is-incorrect');
                    }
                }

                // Show feedback icon
                if (feedbackIcon) {
                    feedbackIcon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
                    if (isCorrect) {
                        feedbackIcon.classList.add('fa-check-circle', 'text-success');
                    } else {
                        feedbackIcon.classList.add('fa-times-circle', 'text-danger');
                    }
                    feedbackIcon.style.display = 'inline-block';
                }

                // Add detailed solution
                const solutionItem = document.createElement('div');
                solutionItem.classList.add('solution-item');

                const questionTextSolutionDiv = document.createElement('div');
                questionTextSolutionDiv.classList.add('question-text-solution');
                
                // Reconstruct the sentence with the correct answer highlighted
                const fullTextWithCorrectAnswer = questionInfo.text_parts[0] + 
                                                   `<span class="correct-answer-text">${questionInfo.correct_answer}</span>` + 
                                                   (questionInfo.text_parts[1] || '');
                // Use the original question number from the image (e.g., q2_across -> 2)
                const originalQuestionNumber = qId.split('_')[0].substring(1); 
                questionTextSolutionDiv.innerHTML = `${originalQuestionNumber}. ${fullTextWithCorrectAnswer}`;
                solutionItem.appendChild(questionTextSolutionDiv);

                const grammarExplanationDiv = document.createElement('div');
                grammarExplanationDiv.classList.add('grammar-explanation');
                grammarExplanationDiv.innerHTML = `<strong>Giải thích ngữ pháp & ngữ cảnh:</strong> ${questionInfo.explanation}<br>${questionInfo.grammar_note}`;
                solutionItem.appendChild(grammarExplanationDiv);

                const translationDiv = document.createElement('div');
                translationDiv.classList.add('translation');
                translationDiv.innerHTML = `<strong>Dịch:</strong> ${questionInfo.translation}`;
                solutionItem.appendChild(translationDiv);

                solutionListDiv.appendChild(solutionItem);
            });

            // Display score
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.textContent = `Bạn đã đạt ${score} / ${totalQuestions} điểm.`;

            // Apply color coding to score display based on performance
            scoreDisplay.classList.remove('text-success', 'text-warning', 'text-danger');
            if (score === totalQuestions) {
                scoreDisplay.classList.add('text-success');
            } else if (score >= totalQuestions / 2) {
                scoreDisplay.classList.add('text-warning');
            } else {
                scoreDisplay.classList.add('text-danger');
            }
            scoreDisplay.style.display = 'block'; // Show the score display

            // Scroll to the score display
            scoreDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        /**
         * Resets the exercise by clearing input fields, hiding feedback, score, and solutions.
         */
        function resetExercise() {
            const textInputs = document.querySelectorAll('input[type="text"]');
            textInputs.forEach(input => {
                input.value = ''; // Clear text input
                input.classList.remove('is-correct', 'is-incorrect'); // Remove feedback classes
            });

            const feedbackIcons = document.querySelectorAll('.feedback-icon');
            feedbackIcons.forEach(icon => {
                icon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
                icon.style.display = 'none'; // Hide feedback icon
            });

            document.getElementById('scoreDisplay').textContent = ''; // Clear score text
            document.getElementById('scoreDisplay').style.display = 'none'; // Hide score display
            document.getElementById('detailedSolution').style.display = 'none'; // Hide solution section
            document.querySelector('#detailedSolution .solution-list').innerHTML = ''; // Clear solutions list
        }
    </script>
</body>
</html>
