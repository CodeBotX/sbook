<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Correct the Word - English Exercise</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f2f5;
            line-height: 1.6;
            color: #333;
            padding: 20px;
        }
        .container-main {
            max-width: 900px;
            margin: 40px auto;
            background-color: #ffffff;
            padding: 35px 45px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
        }
        .instruction {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #555;
            text-align: center;
            line-height: 1.5;
        }

        .exercise-text {
            background-color: #fdfdfd;
            border: 1px solid #e0e0e0;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            line-height: 2.2;
        }
        .question-line {
            display: flex;
            align-items: baseline;
            margin-bottom: 15px;
            font-size: 1.05em;
        }
        .question-number {
            font-weight: bold;
            color: #2c3e50;
            margin-right: 10px;
            width: 25px;
            text-align: right;
            flex-shrink: 0;
        }
        .bold-wrong-word {
            font-weight: bold;
            color: #dc3545; /* Red for wrong bold word */
            text-decoration: line-through; /* Strikethrough for wrong word */
            margin: 0 3px;
        }
        .answer-input {
            width: 120px;
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid #ced4da;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            display: inline-block;
            margin-left: 15px; /* Margin to separate from question */
            vertical-align: middle;
        }
        .answer-input:focus {
            border-color: #86b7fe;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }
        .answer-input.is-valid {
            border-color: #198754 !important;
            box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25) !important;
            background-color: #d1e7dd;
            color: #0f5132;
        }
        .answer-input.is-invalid {
            border-color: #dc3545 !important;
            box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25) !important;
            background-color: #f8d7da;
            color: #842029;
        }

        .buttons .btn {
            padding: 12px 30px;
            font-size: 1.1em;
            margin: 0 15px;
            border-radius: 30px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .buttons .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        .score-display {
            font-size: 1.3em;
            font-weight: 700;
            color: #007bff;
            margin-top: 30px;
            margin-bottom: 25px;
            text-align: center;
            padding: 10px 20px;
            border-radius: 8px;
            background-color: #e6f7ff;
            border: 1px solid #b3e0ff;
        }
        .score-display.text-success { background-color: #d1e7dd; border-color: #a3cfb4; color: #198754; }
        .score-display.text-warning { background-color: #fff3cd; border-color: #ffeeba; color: #ffc107; }
        .score-display.text-danger { background-color: #f8d7da; border-color: #f5c2c7; color: #dc3545; }

        .solution-section {
            margin-top: 40px;
            padding-top: 25px;
            border-top: 1px dashed #ced4da;
            display: none; /* Hidden by default */
        }
        .solution-section h2 {
            color: #007bff;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
        }
        .solution-list .solution-item {
            margin-bottom: 20px;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-left: 5px solid #007bff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .solution-list .solution-item .question-text-solution {
            font-weight: 600;
            color: #34495e;
            margin-bottom: 8px;
        }
        .solution-list .solution-item .correct-answer-text-solution {
            font-weight: 700;
            color: #198754;
            text-decoration: underline;
        }
        .solution-list .solution-item .explanation {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
            background-color: #e9ecef;
            padding: 8px 12px;
            border-radius: 5px;
            border-left: 3px solid #6c757d;
        }
        .solution-list .solution-item .translation {
            font-style: italic;
            color: #6c757d;
            font-size: 0.95em;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #e0e0e0;
        }
    </style>
</head>
<body>
    <div class="container container-main">
        <div class="d-flex align-items-center justify-content-center mb-4">
            <span class="badge bg-primary fs-6 me-2">I</span>
            <h1>Each of the words in bold is wrong. Write the correct word.</h1>
        </div>
        <p class="instruction">
            Mỗi từ được in đậm là sai. Hãy viết từ đúng vào chỗ trống.
            <br>
            <span class="text-muted">(Lưu ý: Đáp án và lời giải chi tiết sẽ hiển thị sau khi bạn nhấn "Kiểm tra".)</span>
        </p>

        <form id="correctWordForm">
            <div class="exercise-text">
                <div class="question-line">
                    <span class="question-number">1</span> I'm completely crazy <span class="bold-wrong-word">with</span> skateboarding! I love it!
                    <input type="text" class="form-control answer-input" id="q1" name="q1">
                </div>
                <div class="question-line">
                    <span class="question-number">2</span> In my free time I listen <span class="bold-wrong-word">on</span> music on CD or on the radio.
                    <input type="text" class="form-control answer-input" id="q2" name="q2">
                </div>
                <div class="question-line">
                    <span class="question-number">3</span> Elsa isn't very keen <span class="bold-wrong-word">for</span> this group, but they're one of my favourites.
                    <input type="text" class="form-control answer-input" id="q3" name="q3">
                </div>
                <div class="question-line">
                    <span class="question-number">4</span> Next week we've got a game <span class="bold-wrong-word">to</span> a team from Hungary.
                    <input type="text" class="form-control answer-input" id="q4" name="q4">
                </div>
                <div class="question-line">
                    <span class="question-number">5</span> Is that Kylie? Oh, I'm a really big fan <span class="bold-wrong-word">from</span> hers.
                    <input type="text" class="form-control answer-input" id="q5" name="q5">
                </div>
                <div class="question-line">
                    <span class="question-number">6</span> I was really scared when I took part <span class="bold-wrong-word">to</span> the singing competition last year.
                    <input type="text" class="form-control answer-input" id="q6" name="q6">
                </div>
            </div>

            <div class="buttons text-center mt-5">
                <button type="button" class="btn btn-primary me-3" onclick="submitAnswers()">Kiểm tra</button>
                <button type="button" class="btn btn-secondary" onclick="resetExercise()">Làm lại</button>
            </div>
        </form>

        <div id="scoreDisplay" class="score-display mt-4"></div>

        <div class="solution-section" id="detailedSolution">
            <h2>Lời giải chi tiết và Giải thích</h2>
            <div class="solution-list">
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTFyMfwGpGFFRKKoXpQf/ZtVKKjoF+L7ffy4qC7zQtxHiJitjEATj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkmXLRV5vfJzJrEPiniwz4rsVZpGgG8Y1r+KNuGMuwtj44gJjEnFqVfXpX5f" crossorigin="anonymous"></script>

    <script>
        const correctAnswers = {
            'q1': {
                wrong_word: 'with',
                correct: 'about',
                sentence_parts: ['I\'m completely crazy ', ' skateboarding! I love it!'],
                explanation: '"Crazy about" là cụm giới từ cố định, có nghĩa là rất thích, rất mê cái gì đó. "Crazy with" không phải là cách diễn đạt phổ biến trong ngữ cảnh này.',
                translation: 'Tôi hoàn toàn mê trượt ván! Tôi yêu nó!',
            },
            'q2': {
                wrong_word: 'on',
                correct: 'to',
                sentence_parts: ['In my free time I listen ', ' music on CD or on the radio.'],
                explanation: '"Listen to" là cụm động từ cố định, có nghĩa là nghe cái gì đó. Giới từ "to" là bắt buộc khi nói về việc nghe nhạc, radio, v.v.',
                translation: 'Trong thời gian rảnh, tôi nghe nhạc trên đĩa CD hoặc trên radio.',
            },
            'q3': {
                wrong_word: 'for',
                correct: 'on',
                sentence_parts: ['Elsa isn\'t very keen ', ' this group, but they\'re one of my favourites.'],
                explanation: '"Keen on" là cụm tính từ cố định, có nghĩa là thích thú, say mê cái gì đó. "Keen for" thường dùng khi nói về việc mong muốn cái gì đó xảy ra ("keen for something to happen").',
                translation: 'Elsa không thích nhóm nhạc này lắm, nhưng họ là một trong những nhóm yêu thích của tôi.',
            },
            'q4': {
                wrong_word: 'to',
                correct: 'against',
                sentence_parts: ['Next week we\'ve got a game ', ' a team from Hungary.'],
                explanation: 'Khi nói về một trận đấu giữa hai đội, chúng ta dùng giới từ "against" (chống lại, đối đầu với).',
                translation: 'Tuần tới chúng ta có một trận đấu với một đội từ Hungary.',
            },
            'q5': {
                wrong_word: 'from',
                correct: 'of',
                sentence_parts: ['Is that Kylie? Oh, I\'m a really big fan ', ' hers.'],
                explanation: '"A fan of" là cụm danh từ cố định, có nghĩa là người hâm mộ của ai/cái gì đó. Giới từ "of" được dùng để chỉ mối quan hệ sở hữu hoặc liên kết.',
                translation: 'Đó có phải là Kylie không? Ồ, tôi là một fan hâm mộ lớn của cô ấy.',
            },
            'q6': {
                wrong_word: 'to',
                correct: 'in',
                sentence_parts: ['I was really scared when I took part ', ' the singing competition last year.'],
                explanation: '"Take part in" là cụm động từ cố định, có nghĩa là tham gia vào một sự kiện, hoạt động. "Take part to" là không đúng ngữ pháp.',
                translation: 'Tôi đã rất sợ hãi khi tham gia cuộc thi hát năm ngoái.',
            },
        };

        function normalizeAnswer(answer) {
            return answer.toLowerCase().trim();
        }

        function submitAnswers() {
            let score = 0;
            const totalQuestions = Object.keys(correctAnswers).length;
            const solutionListDiv = document.querySelector('#detailedSolution .solution-list');
            solutionListDiv.innerHTML = ''; // Clear previous solutions
            document.getElementById('detailedSolution').style.display = 'block'; // Show solution section

            Object.keys(correctAnswers).forEach(qId => {
                const inputElement = document.getElementById(qId);
                if (!inputElement) return;

                const userAnswer = normalizeAnswer(inputElement.value);
                const correctInfo = correctAnswers[qId];
                const isCorrect = normalizeAnswer(correctInfo.correct) === userAnswer;

                inputElement.classList.remove('is-valid', 'is-invalid');
                if (isCorrect) {
                    score++;
                    inputElement.classList.add('is-valid');
                } else {
                    inputElement.classList.add('is-invalid');
                }
                // Always display the correct answer in the input field after checking
                inputElement.value = correctInfo.correct;

                // Add detailed solution for each question
                const solutionItem = document.createElement('div');
                solutionItem.classList.add('solution-item');

                const questionNumber = qId.substring(1);
                const questionTextDiv = document.createElement('div');
                questionTextDiv.classList.add('question-text-solution');

                // Reconstruct sentence with correct answer, showing wrong word struck out
                const fullSentenceHtml = `<strong>Câu ${questionNumber}:</strong> ${correctInfo.sentence_parts[0]}<span class="bold-wrong-word">${correctInfo.wrong_word}</span> <span class="correct-answer-text-solution">${correctInfo.correct}</span>${correctInfo.sentence_parts[1]}`;
                
                questionTextDiv.innerHTML = fullSentenceHtml;
                solutionItem.appendChild(questionTextDiv);

                // Add explanation
                const explanationDiv = document.createElement('div');
                explanationDiv.classList.add('explanation');
                explanationDiv.innerHTML = `<strong>Giải thích:</strong> ${correctInfo.explanation}`;
                solutionItem.appendChild(explanationDiv);

                // Add translation
                const translationDiv = document.createElement('div');
                translationDiv.classList.add('translation');
                translationDiv.innerHTML = `<strong>Dịch:</strong> ${correctInfo.translation}`;
                solutionItem.appendChild(translationDiv);
                
                solutionListDiv.appendChild(solutionItem);
            });

            // Display score
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.textContent = `Bạn đã đạt ${score} / ${totalQuestions} điểm.`;

            scoreDisplay.classList.remove('text-success', 'text-warning', 'text-danger');
            if (score === totalQuestions) {
                scoreDisplay.classList.add('text-success');
            } else if (score >= totalQuestions / 2) {
                scoreDisplay.classList.add('text-warning');
            } else {
                scoreDisplay.classList.add('text-danger');
            }
        }

        function resetExercise() {
            const inputs = document.querySelectorAll('.answer-input');
            inputs.forEach(input => {
                input.value = '';
                input.classList.remove('is-valid', 'is-invalid');
            });

            document.getElementById('scoreDisplay').textContent = ''; // Clear score
            document.getElementById('detailedSolution').style.display = 'none'; // Hide solution section
            document.querySelector('#detailedSolution .solution-list').innerHTML = ''; // Clear solutions
        }
    </script>
</body>
</html>