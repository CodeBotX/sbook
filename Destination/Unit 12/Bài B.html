<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Điền Từ Sắp Xếp Chữ Cái</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* General body styling */
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f2f5;
            line-height: 1.6;
            color: #333;
            padding-top: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        /* Main container for the exercise */
        .container-main {
            max-width: 900px;
            margin-top: 40px;
            margin-bottom: 40px;
            background-color: #ffffff;
            padding: 35px 45px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Headings */
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
        }
        h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600;
        }

        /* Instruction section styling */
        .instruction {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #555;
            text-align: center;
            line-height: 1.5;
            background-color: #e8f5e9;
            border-left: 6px solid #4CAF50;
            padding: 20px 25px;
            border-radius: 10px;
            color: #388e3c;
        }

        /* Styling for each exercise question */
        .question-item {
            margin-bottom: 30px; /* Increased margin for better separation */
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background-color: #fdfdfd;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }
        .question-item .question-text {
            font-size: 1.1em;
            font-weight: 600;
            color: #34495e;
            margin-right: 15px;
            flex-grow: 1; /* Allow text to take available space */
            display: flex; /* For inline input alignment */
            align-items: center;
            flex-wrap: wrap;
        }
        .question-item .question-text input[type="text"] {
            display: inline-block;
            width: 180px; /* Adjust width as needed */
            margin: 0 5px;
            padding: 0 5px; /* Reduced padding for underline effect */
            border: none; /* Remove all borders */
            border-bottom: 1px solid #ced4da; /* Only bottom border */
            border-radius: 0; /* Remove border-radius for a clean underline */
            font-size: 1em;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: transparent; /* Ensure background is transparent */
            text-align: center; /* Center text in input */
        }
        .question-item .question-text input[type="text"]:focus {
            border-color: #80bdff;
            outline: 0;
            box-shadow: none; /* Remove box-shadow on focus for underline effect */
            border-bottom-width: 2px; /* Thicker underline on focus */
        }
        /* Styles for correct and incorrect input feedback */
        .question-item .question-text input[type="text"].is-correct {
            border-color: #198754;
            box-shadow: none; /* Remove box-shadow */
            border-bottom-width: 2px; /* Thicker underline for correct */
        }
        .question-item .question-text input[type="text"].is-incorrect {
            border-color: #dc3545;
            box-shadow: none; /* Remove box-shadow */
            border-bottom-width: 2px; /* Thicker underline for incorrect */
        }

        .jumbled-letters {
            font-family: 'Courier New', monospace; /* Monospace font for jumbled letters */
            font-weight: 700;
            font-size: 1.1em;
            color: #007bff;
            background-color: #eaf6ff;
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px dashed #007bff;
            min-width: 80px; /* Ensure a consistent width */
            text-align: center;
            margin-left: auto; /* Push to the right */
        }

        /* Feedback icons */
        .feedback-icon {
            margin-left: 10px;
            font-size: 1.2em;
            display: none; /* Hidden by default, shown by JS */
            vertical-align: middle;
        }
        .feedback-icon.text-success { color: #198754; }
        .feedback-icon.text-danger { color: #dc3545; }

        /* Buttons styling */
        .buttons .btn {
            padding: 12px 30px;
            font-size: 1.1em;
            margin: 0 15px;
            border-radius: 30px; /* Pill-shaped buttons */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .buttons .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        /* Score display styling */
        .score-display {
            font-size: 1.3em;
            font-weight: 700;
            color: #007bff;
            margin-top: 30px;
            margin-bottom: 25px;
            text-align: center;
            padding: 10px 20px;
            border-radius: 8px;
            background-color: #e6f7ff;
            border: 1px solid #b3e0ff;
            display: none; /* Hidden by default */
        }
        /* Score display color coding */
        .score-display.text-success { background-color: #d1e7dd; border-color: #a3cfb4; color: #198754; }
        .score-display.text-warning { background-color: #fff3cd; border-color: #ffeeba; color: #ffc107; }
        .score-display.text-danger { background-color: #f8d7da; border-color: #f5c2c7; color: #dc3545; }

        /* Detailed solution section styling */
        .solution-section {
            margin-top: 40px;
            padding-top: 25px;
            border-top: 1px dashed #ced4da;
            display: none; /* Hidden by default */
        }
        .solution-section h2 {
            color: #007bff;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
        }
        .solution-list .solution-item {
            margin-bottom: 20px;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-left: 5px solid #007bff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .solution-list .solution-item .question-text-solution {
            font-weight: 600;
            color: #34495e;
            margin-bottom: 8px;
        }
        .solution-list .solution-item .correct-answer-text {
            font-weight: 700;
            color: #198754;
            text-decoration: underline;
            margin-right: 5px;
        }
        .solution-list .solution-item .grammar-explanation {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
            background-color: #e9ecef;
            padding: 8px 12px;
            border-radius: 5px;
            border-left: 3px solid #6c757d;
        }
        .solution-list .solution-item .translation {
            font-style: italic;
            color: #6c757d;
            font-size: 0.95em;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #e0e0e0;
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 768px) {
            .container-main {
                padding: 25px;
                margin: 20px auto;
            }
            h1 {
                font-size: 1.8em;
            }
            h2 {
                font-size: 1.5em;
            }
            .instruction {
                font-size: 0.95em;
                padding: 15px;
            }
            .question-item {
                padding: 15px;
                margin-bottom: 20px;
                flex-direction: column; /* Stack items vertically */
                align-items: flex-start; /* Align text to left */
            }
            .question-item .question-text {
                font-size: 1em;
                margin-bottom: 10px;
                margin-right: 0;
                width: 100%; /* Full width for text */
            }
            .question-item .question-text input[type="text"] {
                width: 100%; /* Full width for inputs on small screens */
                margin: 5px 0;
                padding: 0 4px; /* Adjusted padding */
            }
            .jumbled-letters {
                margin-left: 0; /* Remove auto margin */
                width: 100%; /* Full width */
                margin-top: 10px; /* Space between text and jumbled letters */
            }
            .buttons .btn {
                font-size: 1.1em;
                padding: 10px 25px;
                margin: 0 8px;
            }
            .score-display {
                font-size: 1.3em;
                padding: 12px;
            }
            .solution-list .solution-item {
                padding: 10px 15px;
            }
            .solution-list .solution-item .grammar-explanation,
            .solution-list .solution-item .translation {
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <div class="container container-main">
        <div class="d-flex align-items-center justify-content-center mb-4">
            <h1>Bài Tập Điền Từ Sắp Xếp Chữ Cái</h1>
        </div>
        <h2>Hoàn thành bằng cách sử dụng một từ được tạo từ các chữ cái đã cho.</h2>
        <p class="instruction">
            <strong>Instructions:</strong> Complete using a word formed from the letters given.
            <br>
            <strong>Hướng dẫn:</strong> Điền từ thích hợp bằng cách sắp xếp lại các chữ cái cho sẵn.
            <br>
            <span class="text-muted">(Lưu ý: Đáp án và lời giải chi tiết sẽ hiển thị sau khi bạn nhấn "Kiểm tra".)</span>
        </p>

        <form id="fillInTheBlanksForm">
            <div class="mb-4">
                <div class="question-item">
                    <p class="question-text">1. Don't you think Ben and Angie make a lovely <input type="text" id="q1" name="q1" class="form-control"></p>
                    <span class="jumbled-letters">LEOPUC</span>
                    <i class="feedback-icon fa-solid" id="icon1"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">2. How many <input type="text" id="q2" name="q2" class="form-control"> are staying at the hotel at the moment?</p>
                    <span class="jumbled-letters">SEGUTS</span>
                    <i class="feedback-icon fa-solid" id="icon2"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">3. All our <input type="text" id="q3" name="q3" class="form-control"> are coming to the wedding.</p>
                    <span class="jumbled-letters">SNOREALIT</span>
                    <i class="feedback-icon fa-solid" id="icon3"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">4. A <input type="text" id="q4" name="q4" class="form-control"> is just a friend you haven't met yet!</p>
                    <span class="jumbled-letters">GRANTERS</span>
                    <i class="feedback-icon fa-solid" id="icon4"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">5. How long have you been going out with your <input type="text" id="q5" name="q5" class="form-control">?</p>
                    <span class="jumbled-letters">DRINFEBYOB</span>
                    <i class="feedback-icon fa-solid" id="icon5"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">6. Why are you in such a bad <input type="text" id="q6" name="q6" class="form-control">?</p>
                    <span class="jumbled-letters">ODOM</span>
                    <i class="feedback-icon fa-solid" id="icon6"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">7. My grandparents live in a really quiet <input type="text" id="q7" name="q7" class="form-control">.</p>
                    <span class="jumbled-letters">OHIDROUGHONE</span>
                    <i class="feedback-icon fa-solid" id="icon7"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">8. My cousin has just moved into a <input type="text" id="q8" name="q8" class="form-control"> in the city centre.</p>
                    <span class="jumbled-letters">ATLF</span>
                    <i class="feedback-icon fa-solid" id="icon8"></i>
                </div>

                <div class="question-item">
                    <p class="question-text">9. I'm going to the cinema with my <input type="text" id="q9" name="q9" class="form-control"> tonight.</p>
                    <span class="jumbled-letters">REDGINFLIR</span>
                    <i class="feedback-icon fa-solid" id="icon9"></i>
                </div>
            </div>

            <div class="buttons text-center mt-5">
                <button type="button" class="btn btn-primary me-3" onclick="submitAnswers()">Kiểm tra ✨</button>
                <button type="button" class="btn btn-secondary" onclick="resetExercise()">Làm lại 🔄</button>
            </div>
        </form>

        <div id="scoreDisplay" class="score-display mt-4"></div>

        <div class="solution-section" id="detailedSolution">
            <h2>Lời giải chi tiết và Giải thích</h2>
            <div class="solution-list">
                </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        // Define correct answers, full sentences, explanations, and translations for each question.
        const questionsData = {
            'q1': {
                text_parts: ["Don't you think Ben and Angie make a lovely ", "?"],
                jumbled: 'LEOPUC',
                correct_answer: 'couple',
                fullSentence: "Don't you think Ben and Angie make a lovely couple?",
                translation: 'Bạn có nghĩ Ben và Angie tạo thành một cặp đôi đáng yêu không?',
                explanation: 'Từ "couple" (cặp đôi) phù hợp nhất với ngữ cảnh Ben và Angie, hai người thường được coi là một đôi.',
                grammar_note: '"A lovely couple" là cụm từ phổ biến để mô tả một cặp đôi đẹp.'
            },
            'q2': {
                text_parts: ["How many ", " are staying at the hotel at the moment?"],
                jumbled: 'SEGUTS',
                correct_answer: 'guests',
                fullSentence: "How many guests are staying at the hotel at the moment?",
                translation: 'Hiện tại có bao nhiêu khách đang ở khách sạn?',
                explanation: 'Từ "guests" (khách) là phù hợp nhất khi nói về những người ở trong khách sạn.',
                grammar_note: 'Sử dụng "How many" với danh từ đếm được số nhiều.'
            },
            'q3': {
                text_parts: ["All our ", " are coming to the wedding."],
                jumbled: 'SNOREALIT',
                correct_answer: 'relations',
                fullSentence: "All our relations are coming to the wedding.",
                translation: 'Tất cả họ hàng của chúng tôi đang đến dự đám cưới.',
                explanation: 'Từ "relations" (họ hàng) là những người thân trong gia đình, thường tham dự các sự kiện như đám cưới.',
                grammar_note: '"Relations" (số nhiều) có nghĩa là họ hàng, người thân.'
            },
            'q4': {
                text_parts: ["A ", " is just a friend you haven't met yet!"],
                jumbled: 'GRANTERS',
                correct_answer: 'stranger',
                fullSentence: "A stranger is just a friend you haven't met yet!",
                translation: 'Người lạ chỉ là một người bạn mà bạn chưa gặp!',
                explanation: 'Câu định nghĩa này chỉ về "stranger" (người lạ) - một người chưa từng gặp trước đây.',
                grammar_note: 'Dùng mạo từ "a" trước danh từ số ít đếm được "stranger".'
            },
            'q5': {
                text_parts: ["How long have you been going out with your ", "?"],
                jumbled: 'DRINFEBYOB',
                correct_answer: 'boyfriend',
                fullSentence: "How long have you been going out with your boyfriend?",
                translation: 'Bạn đã hẹn hò với bạn trai của bạn được bao lâu rồi?',
                explanation: 'Cụm từ "going out with" (hẹn hò với) thường đi kèm với "boyfriend" (bạn trai) hoặc "girlfriend".',
                grammar_note: 'Thì hiện tại hoàn thành tiếp diễn "How long have you been going out with" dùng để hỏi về khoảng thời gian của một hành động bắt đầu trong quá khứ và tiếp diễn đến hiện tại.'
            },
            'q6': {
                text_parts: ["Why are you in such a bad ", "?"],
                jumbled: 'ODOM',
                correct_answer: 'mood',
                fullSentence: "Why are you in such a bad mood?",
                translation: 'Tại sao bạn lại có tâm trạng tồi tệ như vậy?',
                explanation: 'Cụm từ "in a bad mood" (tâm trạng tệ) là cách diễn đạt phổ biến khi ai đó đang khó chịu hoặc không vui.',
                grammar_note: 'Cụm từ cố định: "in a mood".'
            },
            'q7': {
                text_parts: ["My grandparents live in a really quiet ", "."],
                jumbled: 'OHIDROUGHONE',
                correct_answer: 'neighbourhood',
                fullSentence: "My grandparents live in a really quiet neighbourhood.",
                translation: 'Ông bà tôi sống trong một khu phố thực sự yên tĩnh.',
                explanation: 'Từ "neighbourhood" (khu phố, khu dân cư) là nơi mà mọi người sinh sống, phù hợp với việc mô tả một "quiet" (yên tĩnh) place.',
                grammar_note: '"Neighbourhood" là danh từ để chỉ một khu vực cụ thể trong thành phố/thị trấn.'
            },
            'q8': {
                text_parts: ["My cousin has just moved into a ", " in the city centre."],
                jumbled: 'ATLF',
                correct_answer: 'flat',
                fullSentence: "My cousin has just moved into a flat in the city centre.",
                translation: 'Anh họ tôi vừa chuyển đến một căn hộ ở trung tâm thành phố.',
                explanation: 'Từ "flat" (căn hộ) là một nơi ở, thường được tìm thấy ở trung tâm thành phố. "Moved into" (chuyển đến) gợi ý một nơi ở.',
                grammar_note: 'Từ "flat" ở Anh tương đương với "apartment" ở Mỹ.'
            },
            'q9': {
                text_parts: ["I'm going to the cinema with my ", " tonight."],
                jumbled: 'REDGINFLIR',
                correct_answer: 'girlfriend',
                fullSentence: "I'm going to the cinema with my girlfriend tonight.",
                translation: 'Tối nay tôi sẽ đi xem phim với bạn gái.',
                explanation: 'Cụm từ "going to the cinema with my..." thường đi kèm với "girlfriend" (bạn gái) hoặc "boyfriend", chỉ người mà bạn có mối quan hệ lãng mạn.',
                grammar_note: 'Sử dụng "my" để chỉ sở hữu. "Going to" + địa điểm là cách diễn đạt một kế hoạch trong tương lai gần.'
            }
        };

        /**
         * Submits the user's answers, calculates the score, provides feedback,
         * and displays detailed solutions.
         */
        function submitAnswers() {
            let score = 0;
            const totalQuestions = Object.keys(questionsData).length;

            const solutionListDiv = document.querySelector('#detailedSolution .solution-list');
            solutionListDiv.innerHTML = ''; // Clear previous solutions
            document.getElementById('detailedSolution').style.display = 'block'; // Show solution section

            // Iterate through each question
            Object.keys(questionsData).forEach(qId => {
                const questionInfo = questionsData[qId];
                const inputElement = document.getElementById(qId);
                const feedbackIcon = document.getElementById(`icon${qId.substring(1)}`);

                // Reset feedback classes
                inputElement.classList.remove('is-correct', 'is-incorrect');

                const userAnswer = inputElement.value.trim().toLowerCase();
                const correctAnswer = questionInfo.correct_answer.toLowerCase();

                let isCorrect = false;
                if (userAnswer === correctAnswer) {
                    isCorrect = true;
                    score++;
                    inputElement.classList.add('is-correct');
                } else {
                    inputElement.classList.add('is-incorrect');
                }

                // Show feedback icon
                if (feedbackIcon) {
                    feedbackIcon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
                    if (isCorrect) {
                        feedbackIcon.classList.add('fa-check-circle', 'text-success');
                    } else {
                        feedbackIcon.classList.add('fa-times-circle', 'text-danger');
                    }
                    feedbackIcon.style.display = 'inline-block';
                }

                // Add detailed solution
                const solutionItem = document.createElement('div');
                solutionItem.classList.add('solution-item');

                const questionNumber = qId.substring(1);
                const questionTextSolutionDiv = document.createElement('div');
                questionTextSolutionDiv.classList.add('question-text-solution');

                // Reconstruct the sentence with the correct answer
                const fullTextHtml = `${questionNumber}. ${questionInfo.text_parts[0]} <span class="correct-answer-text">${questionInfo.correct_answer}</span> ${questionInfo.text_parts[1] || ''}`;
                questionTextSolutionDiv.innerHTML = fullTextHtml;
                solutionItem.appendChild(questionTextSolutionDiv);

                const grammarExplanationDiv = document.createElement('div');
                grammarExplanationDiv.classList.add('grammar-explanation');
                grammarExplanationDiv.innerHTML = `<strong>Giải thích ngữ pháp & ngữ cảnh:</strong> ${questionInfo.explanation}<br><em>${questionInfo.grammar_note}</em>`;
                solutionItem.appendChild(grammarExplanationDiv);

                const translationDiv = document.createElement('div');
                translationDiv.classList.add('translation');
                translationDiv.innerHTML = `<strong>Dịch:</strong> ${questionInfo.translation}`;
                solutionItem.appendChild(translationDiv);

                solutionListDiv.appendChild(solutionItem);
            });

            // Display score
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.textContent = `Bạn đã đạt ${score} / ${totalQuestions} điểm.`;

            // Apply color coding to score display based on performance
            scoreDisplay.classList.remove('text-success', 'text-warning', 'text-danger');
            if (score === totalQuestions) {
                scoreDisplay.classList.add('text-success');
            } else if (score >= totalQuestions / 2) {
                scoreDisplay.classList.add('text-warning');
            } else {
                scoreDisplay.classList.add('text-danger');
            }
            scoreDisplay.style.display = 'block'; // Show the score display

            // Scroll to the score display
            scoreDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        /**
         * Resets the exercise by clearing input fields, hiding feedback, score, and solutions.
         */
        function resetExercise() {
            const textInputs = document.querySelectorAll('input[type="text"]');
            textInputs.forEach(input => {
                input.value = ''; // Clear text input
                input.classList.remove('is-correct', 'is-incorrect'); // Remove feedback classes
            });

            const feedbackIcons = document.querySelectorAll('.feedback-icon');
            feedbackIcons.forEach(icon => {
                icon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
                icon.style.display = 'none'; // Hide feedback icon
            });

            document.getElementById('scoreDisplay').textContent = ''; // Clear score text
            document.getElementById('scoreDisplay').style.display = 'none'; // Hide score display
            document.getElementById('detailedSolution').style.display = 'none'; // Hide solution section
            document.querySelector('#detailedSolution .solution-list').innerHTML = ''; // Clear solutions list
        }
    </script>
</body>
</html>