<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Ngữ Pháp và Từ Vựng</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Google Fonts for 'Open Sans' -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* General body styling */
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f2f5;
            line-height: 1.6;
            color: #333;
            padding-top: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        /* Main container for the exercise */
        .container-main {
            max-width: 950px;
            margin-top: 40px;
            margin-bottom: 40px;
            background-color: #ffffff;
            padding: 35px 45px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Headings */
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
        }
        h2 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* Instruction section styling */
        .instruction {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #555;
            text-align: center;
            line-height: 1.5;
            background-color: #e8f5e9;
            border-left: 6px solid #4CAF50;
            padding: 20px 25px;
            border-radius: 10px;
            color: #388e3c;
        }

        /* Question item styling */
        .question-item {
            display: flex;
            align-items: baseline;
            margin-bottom: 15px;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }
        .question-item .question-number {
            font-weight: 700;
            margin-right: 10px;
            color: #007bff;
            font-size: 1.1em;
            flex-shrink: 0;
            width: 30px; /* Fixed width for alignment */
            text-align: right;
        }
        .question-item .question-content {
            flex-grow: 1;
            font-size: 1em;
            color: #34495e;
            line-height: 1.5;
            /* Default to inline-flex for sentence flow */
            display: inline-flex;
            flex-wrap: wrap;
            align-items: baseline;
            gap: 5px; /* Small gap between sentence parts and options */
        }
        .question-item .question-content > span {
            display: inline; /* Ensure text parts remain inline */
        }

        /* Styles for interactive options */
        .option-group {
            display: inline-flex; /* Use inline-flex to keep options together in sentence flow */
            flex-wrap: wrap;
            gap: 5px; /* Space between options within the group */
            align-items: baseline;
        }

        .option-item {
            padding: 6px 10px; /* Slightly smaller padding for inline options */
            border: 1px solid #ced4da;
            border-radius: 15px; /* Rounded pill shape */
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease, transform 0.1s ease;
            font-size: 0.95em;
            color: #495057;
            background-color: #f8f9fa;
            user-select: none; /* Prevent text selection on click */
            white-space: nowrap; /* Prevent options from breaking mid-word */
        }

        .option-item:hover {
            background-color: #e9ecef;
            transform: translateY(-1px);
        }

        .option-item.selected-option {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.2);
        }

        /* Feedback for options */
        .option-item.is-correct {
            background-color: #d4edda; /* Light green */
            border-color: #28a745;
            color: #155724;
        }
        .option-item.is-correct.selected-option { /* Preserve selected style for correct */
            background-color: #28a745;
            color: white;
        }


        .option-item.is-incorrect {
            background-color: #f8d7da; /* Light red */
            border-color: #dc3545;
            color: #721c24;
        }
        .option-item.is-incorrect.selected-option { /* Preserve selected style for incorrect */
            background-color: #dc3545;
            color: white;
        }

        /* Hide the original select/input for A/B/C/D if using custom options */
        .question-content select,
        .question-content input[type="hidden"] { /* Target hidden input for storing values */
            display: none;
        }

        /* Ensure feedback icon is always visible when needed */
        .question-item .feedback-icon {
            margin-left: 10px;
            font-size: 1.2em;
            display: none; /* Hidden by default, shown by JS */
            vertical-align: middle;
            flex-shrink: 0;
            align-self: center; /* Align with the center of the options */
        }

        /* For A/B/C/D questions, make the options display block */
        .question-item.d-block .question-content {
            flex-direction: column; /* Stack sentence and options vertically */
            align-items: flex-start;
            display: flex; /* Override inline-flex for these questions */
        }
        .question-item.d-block .question-content .option-group {
            margin-top: 10px; /* More space for multiple choice options */
            display: flex; /* Keep options in a row */
            gap: 8px; /* Standard gap for A/B/C/D */
        }
        .question-item.d-block .question-content .option-item {
            width: auto; /* Allow options to size naturally */
            min-width: 50px; /* Smallest width for A/B/C/D */
            text-align: center;
            padding: 8px 15px; /* Restore larger padding for A/B/C/D */
            border-radius: 20px; /* Restore larger border-radius for A/B/C/D */
        }
        .question-item.d-block .question-content p {
            display: inline; /* Keep the sentence text inline */
        }
        .question-item.d-block .question-content .placeholder-text {
            display: inline-block; /* Placeholder for the gap */
            min-width: 80px; /* Give some width to the placeholder */
            text-align: center;
            border-bottom: 1px dashed #ccc;
            margin: 0 5px;
        }


        @media (max-width: 768px) {
            .container-main {
                padding: 25px;
                margin: 20px auto;
            }
            h1 {
                font-size: 1.8em;
            }
            h2 {
                font-size: 1.5em;
            }
            .instruction {
                font-size: 0.95em;
                padding: 15px;
            }
            .question-item {
                flex-direction: column;
                align-items: flex-start;
            }
            .question-item .question-number {
                width: auto;
                text-align: left;
                margin-bottom: 5px;
            }
            .question-item .question-content {
                width: 100%;
                display: flex; /* Ensure flex for column layout on small screens */
                flex-direction: column;
                align-items: flex-start;
            }
            .option-group {
                flex-direction: column;
                width: 100%;
                gap: 5px; /* Keep small gap for inline options */
            }
            .option-item {
                width: 100%;
                text-align: left;
            }
            .feedback-icon {
                margin-left: 0;
                margin-top: 5px;
                width: 100%;
                text-align: right;
            }
            .buttons .btn {
                font-size: 1em;
                padding: 10px 25px;
                margin: 0 8px;
            }
            .score-display {
                font-size: 1.2em;
                padding: 10px;
            }
            .solution-list .solution-item {
                padding: 10px 15px;
            }
            .solution-list .solution-item .grammar-explanation,
            .solution-list .solution-item .translation {
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container container-main">
        <div class="d-flex align-items-center justify-content-center mb-4">
            <h1>Bài Tập Ngữ Pháp và Từ Vựng Tổng Hợp</h1>
        </div>
        <p class="instruction">
            <strong>Hướng dẫn:</strong> Hoàn thành các câu sau bằng cách chọn hoặc điền từ đúng.
            <br>
            <span class="text-muted">(Lưu ý: Đáp án và lời giải chi tiết sẽ hiển thị sau khi bạn nhấn "Kiểm tra".)</span>
        </p>

        <form id="combinedExerciseForm">
            <h2>I. Chọn dạng đúng của từ/động từ/cụm từ</h2>
            <div class="mb-4">
                <div class="question-item">
                    <span class="question-number">1.</span>
                    <div class="question-content">
                        <span>My full name is Nguyen Van Phuc. I </span>
                        <span class="option-group" id="options-q1">
                            <span class="option-item" data-question-id="q1" data-value="am also called" onclick="selectOption('q1', 'am also called', this)">am also called</span> /
                            <span class="option-item" data-question-id="q1" data-value="am also calling" onclick="selectOption('q1', 'am also calling', this)">am also calling</span>
                        </span>
                        <span> by my English name, which is Jason.</span>
                        <input type="hidden" id="q1" name="q1">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon1"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">2.</span>
                    <div class="question-content">
                        <span>Does your name </span>
                        <span class="option-group" id="options-q2">
                            <span class="option-item" data-question-id="q2" data-value="had" onclick="selectOption('q2', 'had', this)">had</span> /
                            <span class="option-item" data-question-id="q2" data-value="have" onclick="selectOption('q2', 'have', this)">have</span>
                        </span>
                        <span> any special meaning?</span>
                        <input type="hidden" id="q2" name="q2">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon2"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">3.</span>
                    <div class="question-content">
                        <span>If you </span>
                        <span class="option-group" id="options-q3">
                            <span class="option-item" data-question-id="q3" data-value="like" onclick="selectOption('q3', 'like', this)">like</span> /
                            <span class="option-item" data-question-id="q3" data-value="liking" onclick="selectOption('q3', 'liking', this)">liking</span>
                        </span>
                        <span> going out in the evening, there are a lot of good restaurants and bars.</span>
                        <input type="hidden" id="q3" name="q3">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon3"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">4.</span>
                    <div class="question-content">
                        <span>Nam Dinh </span>
                        <span class="option-group" id="options-q4">
                            <span class="option-item" data-question-id="q4" data-value="is" onclick="selectOption('q4', 'is', this)">is</span> /
                            <span class="option-item" data-question-id="q4" data-value="to be" onclick="selectOption('q4', 'to be', this)">to be</span>
                        </span>
                        <span> in the northeast part of Vietnam.</span>
                        <input type="hidden" id="q4" name="q4">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon4"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">5.</span>
                    <div class="question-content">
                        <span>I </span>
                        <span class="option-group" id="options-q5">
                            <span class="option-item" data-question-id="q5" data-value="am living" onclick="selectOption('q5', 'am living', this)">am living</span> /
                            <span class="option-item" data-question-id="q5" data-value="living" onclick="selectOption('q5', 'living', this)">living</span>
                        </span>
                        <span> with my uncle in Hanoi at the moment.</span>
                        <input type="hidden" id="q5" name="q5">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon5"></i>
                </div>
            </div>

            <hr>

            <h2>II. Chọn đáp án đúng nhất (A, B, C, D)</h2>
            <div class="mb-4">
                <div class="question-item d-block">
                    <span class="question-number d-inline-block">6.</span>
                    <div class="question-content d-inline">
                        <p>The bar chart <span class="placeholder-text">_________</span> the number of social networking sites visited by internet users in Canada in 2014 and in 2015.</p>
                        <div class="option-group" id="options-q6">
                            <span class="option-item" data-question-id="q6" data-value="A" onclick="selectOption('q6', 'A', this)">A. shows</span>
                            <span class="option-item" data-question-id="q6" data-value="B" onclick="selectOption('q6', 'B', this)">B. to show</span>
                            <span class="option-item" data-question-id="q6" data-value="C" onclick="selectOption('q6', 'C', this)">C. showing</span>
                            <span class="option-item" data-question-id="q6" data-value="D" onclick="selectOption('q6', 'D', this)">D. be showing</span>
                        </div>
                        <input type="hidden" id="q6" name="q6">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon6"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">7.</span>
                    <div class="question-content d-inline">
                        <p>The line graph <span class="placeholder-text">_________</span> the amount of consumption in different kinds of fast food from 1970 to 1990.</p>
                        <div class="option-group" id="options-q7">
                            <span class="option-item" data-question-id="q7" data-value="A" onclick="selectOption('q7', 'A', this)">A. illustrates</span>
                            <span class="option-item" data-question-id="q7" data-value="B" onclick="selectOption('q7', 'B', this)">B. illustrate</span>
                            <span class="option-item" data-question-id="q7" data-value="C" onclick="selectOption('q7', 'C', this)">C. illustrating</span>
                            <span class="option-item" data-question-id="q7" data-value="D" onclick="selectOption('q7', 'D', this)">D. to illustrate</span>
                        </div>
                        <input type="hidden" id="q7" name="q7">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon7"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">8.</span>
                    <div class="question-content d-inline">
                        <p>In contrast to this, the percentage of people who prefer to travel by car because it is more comfortable <span class="placeholder-text">_________</span> 40%.</p>
                        <div class="option-group" id="options-q8">
                            <span class="option-item" data-question-id="q8" data-value="A" onclick="selectOption('q8', 'A', this)">A. be</span>
                            <span class="option-item" data-question-id="q8" data-value="B" onclick="selectOption('q8', 'B', this)">B. being</span>
                            <span class="option-item" data-question-id="q8" data-value="C" onclick="selectOption('q8', 'C', this)">C. is</span>
                            <span class="option-item" data-question-id="q8" data-value="D" onclick="selectOption('q8', 'D', this)">D. to be</span>
                        </div>
                        <input type="hidden" id="q8" name="q8">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon8"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">9.</span>
                    <div class="question-content d-inline">
                        <p>To specify, after a small decrease from 300 to nearly 200 grams for the first 5 years, the amount of consumption in fish and chips <span class="placeholder-text">_________</span> from 1975 to 1985.</p>
                        <div class="option-group" id="options-q9">
                            <span class="option-item" data-question-id="q9" data-value="A" onclick="selectOption('q9', 'A', this)">A. remaining unchanged</span>
                            <span class="option-item" data-question-id="q9" data-value="B" onclick="selectOption('q9', 'B', this)">B. to remain unchanged</span>
                            <span class="option-item" data-question-id="q9" data-value="C" onclick="selectOption('q9', 'C', this)">C. to be remained unchanged</span>
                            <span class="option-item" data-question-id="q9" data-value="D" onclick="selectOption('q9', 'D', this)">D. remained unchanged</span>
                        </div>
                        <input type="hidden" id="q9" name="q9">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon9"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">10.</span>
                    <div class="question-content d-inline">
                        <p>Despite going up insignificantly from 20 to 30 grams for the first 5 years, the amount of consumption in Pizza <span class="placeholder-text">_________</span> quickly during the remaining years and reached a peak of 180 grams.</p>
                        <div class="option-group" id="options-q10">
                            <span class="option-item" data-question-id="q10" data-value="A" onclick="selectOption('q10', 'A', this)">A. soaring</span>
                            <span class="option-item" data-question-id="q10" data-value="B" onclick="selectOption('q10', 'B', this)">B. soared</span>
                            <span class="option-item" data-question-id="q10" data-value="C" onclick="selectOption('q10', 'C', this)">C. a soar</span>
                            <span class="option-item" data-question-id="q10" data-value="D" onclick="selectOption('q10', 'D', this)">D. to soar</span>
                        </div>
                        <input type="hidden" id="q10" name="q10">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon10"></i>
                </div>
            </div>

            <hr>

            <h2>III. Chọn dạng đúng của từ/cụm từ</h2>
            <div class="mb-4">
                <div class="question-item">
                    <span class="question-number">11.</span>
                    <div class="question-content">
                        <span>Going shopping </span>
                        <span class="option-group" id="options-q11">
                            <span class="option-item" data-question-id="q11" data-value="used to be a chore" onclick="selectOption('q11', 'used to be a chore', this)">used to be a chore</span> /
                            <span class="option-item" data-question-id="q11" data-value="using to be a chore" onclick="selectOption('q11', 'using to be a chore', this)">using to be a chore</span>
                        </span>
                        <span>, but recently it has become a leisure activity.</span>
                        <input type="hidden" id="q11" name="q11">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon11"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">12.</span>
                    <div class="question-content">
                        <span>By contrast, shoppers nowadays </span>
                        <span class="option-group" id="options-q12">
                            <span class="option-item" data-question-id="q12" data-value="can find" onclick="selectOption('q12', 'can find', this)">can find</span> /
                            <span class="option-item" data-question-id="q12" data-value="finding" onclick="selectOption('q12', 'finding', this)">finding</span>
                        </span>
                        <span> almost anything in the supermarket or shopping mall.</span>
                        <input type="hidden" id="q12" name="q12">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon12"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">13.</span>
                    <div class="question-content">
                        <span>To sum up, </span>
                        <span class="option-group" id="options-q13">
                            <span class="option-item" data-question-id="q13" data-value="there are" onclick="selectOption('q13', 'there are', this)">there are</span> /
                            <span class="option-item" data-question-id="q13" data-value="being" onclick="selectOption('q13', 'being', this)">being</span>
                        </span>
                        <span> some services which must be provided by the government such as defense and social security.</span>
                        <input type="hidden" id="q13" name="q13">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon13"></i>
                </div>

                <div class="question-item">
                    <span class="question-number">14.</span>
                    <div class="question-content">
                        <span>Social media </span>
                        <span class="option-group" id="options-q14">
                            <span class="option-item" data-question-id="q14" data-value="be" onclick="selectOption('q14', 'be', this)">be</span> /
                            <span class="option-item" data-question-id="q14" data-value="is" onclick="selectOption('q14', 'is', this)">is</span>
                        </span>
                        <span> becoming increasingly popular amongst all age groups. However, sharing personal information on social websites does have risks.</span>
                        <input type="hidden" id="q14" name="q14">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon14"></i>
                </div>
            </div>

            <hr>

            <h2>IV. Chọn đáp án đúng nhất (A, B, C, D)</h2>
            <div class="mb-4">
                <div class="question-item d-block">
                    <span class="question-number d-inline-block">15.</span>
                    <div class="question-content d-inline">
                        <p>Many parents never let children <span class="placeholder-text">_________</span> their passion, which makes children become tired with their unwanted job in the future.</p>
                        <div class="option-group" id="options-q15">
                            <span class="option-item" data-question-id="q15" data-value="A" onclick="selectOption('q15', 'A', this)">A. follow</span>
                            <span class="option-item" data-question-id="q15" data-value="B" onclick="selectOption('q15', 'B', this)">B. followed</span>
                            <span class="option-item" data-question-id="q15" data-value="C" onclick="selectOption('q15', 'C', this)">C. following</span>
                            <span class="option-item" data-question-id="q15" data-value="D" onclick="selectOption('q15', 'D', this)">D. follows</span>
                        </div>
                        <input type="hidden" id="q15" name="q15">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon15"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">16.</span>
                    <div class="question-content d-inline">
                        <p>There are some strategies that can <span class="placeholder-text">_________</span> used to encourage young people to keep abreast of the news.</p>
                        <div class="option-group" id="options-q16">
                            <span class="option-item" data-question-id="q16" data-value="A" onclick="selectOption('q16', 'A', this)">A. be</span>
                            <span class="option-item" data-question-id="q16" data-value="B" onclick="selectOption('q16', 'B', this)">B. being</span>
                            <span class="option-item" data-question-id="q16" data-value="C" onclick="selectOption('q16', 'C', this)">C. is</span>
                            <span class="option-item" data-question-id="q16" data-value="D" onclick="selectOption('q16', 'D', this)">D. are</span>
                        </div>
                        <input type="hidden" id="q16" name="q16">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon16"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">17.</span>
                    <div class="question-content d-inline">
                        <p>It is important that employers keep <span class="placeholder-text">_________</span> their workers by giving them encouragement frequently.</p>
                        <div class="option-group" id="options-q17">
                            <span class="option-item" data-question-id="q17" data-value="A" onclick="selectOption('q17', 'A', this)">A. inspiring</span>
                            <span class="option-item" data-question-id="q17" data-value="B" onclick="selectOption('q17', 'B', this)">B. inspired</span>
                            <span class="option-item" data-question-id="q17" data-value="C" onclick="selectOption('q17', 'C', this)">C. inspiration</span>
                            <span class="option-item" data-question-id="q17" data-value="D" onclick="selectOption('q17', 'D', this)">D. have inspired</span>
                        </div>
                        <input type="hidden" id="q17" name="q17">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon17"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">18.</span>
                    <div class="question-content d-inline">
                        <p>Crime is an issue of increasing concern around the world, and more money than ever before is being <span class="placeholder-text">_________</span> on the detection and punishment of criminal activity.</p>
                        <div class="option-group" id="options-q18">
                            <span class="option-item" data-question-id="q18" data-value="A" onclick="selectOption('q18', 'A', this)">A. spend</span>
                            <span class="option-item" data-question-id="q18" data-value="B" onclick="selectOption('q18', 'B', this)">B. spending</span>
                            <span class="option-item" data-question-id="q18" data-value="C" onclick="selectOption('q18', 'C', this)">C. spends</span>
                            <span class="option-item" data-question-id="q18" data-value="D" onclick="selectOption('q18', 'D', this)">D. spent</span>
                        </div>
                        <input type="hidden" id="q18" name="q18">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon18"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">19.</span>
                    <div class="question-content d-inline">
                        <p>In some countries an increasing number of people are <span class="placeholder-text">_________</span> from health problems as a result of eating too much fast food.</p>
                        <div class="option-group" id="options-q19">
                            <span class="option-item" data-question-id="q19" data-value="A" onclick="selectOption('q19', 'A', this)">A. suffer</span>
                            <span class="option-item" data-question-id="q19" data-value="B" onclick="selectOption('q19', 'B', this)">B. suffering</span>
                            <span class="option-item" data-question-id="q19" data-value="C" onclick="selectOption('q19', 'C', this)">C. suffers</span>
                            <span class="option-item" data-question-id="q19" data-value="D" onclick="selectOption('q19', 'D', this)">D. to suffer</span>
                        </div>
                        <input type="hidden" id="q19" name="q19">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon19"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">20.</span>
                    <div class="question-content d-inline">
                        <p>From an economic point of view, higher tax might <span class="placeholder-text">_________</span> an effective solution.</p>
                        <div class="option-group" id="options-q20">
                            <span class="option-item" data-question-id="q20" data-value="A" onclick="selectOption('q20', 'A', this)">A. seem</span>
                            <span class="option-item" data-question-id="q20" data-value="B" onclick="selectOption('q20', 'B', this)">B. to seem</span>
                            <span class="option-item" data-question-id="q20" data-value="C" onclick="selectOption('q20', 'C', this)">C. seeming</span>
                            <span class="option-item" data-question-id="q20" data-value="D" onclick="selectOption('q20', 'D', this)">D. seems</span>
                        </div>
                        <input type="hidden" id="q20" name="q20">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon20"></i>
                </div>

                <div class="question-item d-block">
                    <span class="question-number d-inline-block">21.</span>
                    <div class="question-content d-inline">
                        <p>In conclusion, imposing a higher tax on fast food <span class="placeholder-text">_________</span> to be the only way to tackle the problem.</p>
                        <div class="option-group" id="options-q21">
                            <span class="option-item" data-question-id="q21" data-value="A" onclick="selectOption('q21', 'A', this)">A. seem not</span>
                            <span class="option-item" data-question-id="q21" data-value="B" onclick="selectOption('q21', 'B', this)">B. does not seem</span>
                            <span class="option-item" data-question-id="q21" data-value="C" onclick="selectOption('q21', 'C', this)">C. seems</span>
                            <span class="option-item" data-question-id="q21" data-value="D" onclick="selectOption('q21', 'D', this)">D. seem</span>
                        </div>
                        <input type="hidden" id="q21" name="q21">
                    </div>
                    <i class="feedback-icon fa-solid" id="icon21"></i>
                </div>
            </div>

            <div class="buttons text-center mt-5">
                <button type="button" class="btn btn-primary me-3" onclick="submitAnswers()">Kiểm tra ✨</button>
                <button type="button" class="btn btn-secondary" onclick="resetExercise()">Làm lại 🔄</button>
            </div>
        </form>

        <div id="scoreDisplay" class="score-display mt-4"></div>

        <div class="solution-section" id="detailedSolution">
            <h2>Lời giải chi tiết và Giải thích</h2>
            <div class="solution-list">
                <!-- Solutions will be dynamically inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JavaScript bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        // Define correct answers, context, explanations, and translations for each question.
        const questionsData = {
            'q1': {
                correct_answer: 'am also called',
                context: "My full name is Nguyen Van Phuc. I _________ by my English name, which is Jason.",
                translation: 'Tên đầy đủ của tôi là Nguyễn Văn Phúc. Tôi cũng được gọi bằng tên tiếng Anh là Jason.',
                explanation: 'Câu này cần dùng thể bị động (passive voice) vì "tôi" được gọi bởi người khác, không phải tự gọi mình. "Am also called" là dạng bị động đúng.',
                grammar_note: 'Thì hiện tại đơn, thể bị động: S + am/is/are + V3/ed.'
            },
            'q2': {
                correct_answer: 'have',
                context: "Does your name _________ any special meaning?",
                translation: 'Tên của bạn có ý nghĩa đặc biệt nào không?',
                explanation: 'Trong câu hỏi với trợ động từ "Does", động từ chính phải ở dạng nguyên mẫu không "to".',
                grammar_note: 'Cấu trúc câu hỏi thì hiện tại đơn: Do/Does + S + V (nguyên mẫu).'
            },
            'q3': {
                correct_answer: 'like',
                context: "If you _________ going out in the evening, there are a lot of good restaurants and bars.",
                translation: 'Nếu bạn thích đi chơi vào buổi tối, có rất nhiều nhà hàng và quán bar tốt.',
                explanation: 'Mệnh đề điều kiện loại 0 hoặc loại 1, động từ sau "If you" phải ở thì hiện tại đơn.',
                grammar_note: 'Mệnh đề "If": If + S + V (hiện tại đơn), S + V (hiện tại đơn/tương lai đơn).'
            },
            'q4': {
                correct_answer: 'is',
                context: "Nam Dinh _________ in the northeast part of Vietnam.",
                translation: 'Nam Định nằm ở phía đông bắc Việt Nam.',
                explanation: 'Đây là một sự thật hiển nhiên, động từ "to be" chia ở thì hiện tại đơn với chủ ngữ số ít "Nam Dinh".',
                grammar_note: 'Thì hiện tại đơn, động từ "to be".'
            },
            'q5': {
                correct_answer: 'am living',
                context: "I _________ with my uncle in Hanoi at the moment.",
                translation: 'Hiện tại tôi đang sống với chú tôi ở Hà Nội.',
                explanation: 'Trạng từ "at the moment" chỉ ra rằng hành động đang diễn ra tại thời điểm nói, do đó sử dụng thì hiện tại tiếp diễn.',
                grammar_note: 'Thì hiện tại tiếp diễn: S + am/is/are + V-ing. Dùng với các trạng từ như "at the moment", "now".'
            },
            'q6': {
                correct_answer: 'A', // shows
                context: "The bar chart _________ the number of social networking sites visited by internet users in Canada in 2014 and in 2015.",
                translation: 'Biểu đồ cột thể hiện số lượng trang mạng xã hội được người dùng internet ở Canada truy cập vào năm 2014 và 2015.',
                explanation: 'Chủ ngữ "The bar chart" là số ít, động từ cần chia ở thì hiện tại đơn và ở dạng chủ động ("shows"). Các lựa chọn khác không đúng cấu trúc ngữ pháp cho một câu miêu tả biểu đồ.',
                grammar_note: 'Động từ miêu tả biểu đồ ở thì hiện tại đơn với chủ ngữ số ít.'
            },
            'q7': {
                correct_answer: 'A', // illustrates
                context: "The line graph _________ the amount of consumption in different kinds of fast food from 1970 to 1990.",
                translation: 'Biểu đồ đường minh họa lượng tiêu thụ các loại thức ăn nhanh khác nhau từ năm 1970 đến 1990.',
                explanation: 'Tương tự câu 6, chủ ngữ "The line graph" là số ít, động từ cần chia ở thì hiện tại đơn và ở dạng chủ động ("illustrates").',
                grammar_note: 'Động từ miêu tả biểu đồ ở thì hiện tại đơn với chủ ngữ số ít.'
            },
            'q8': {
                correct_answer: 'C', // is
                context: "In contrast to this, the percentage of people who prefer to travel by car because it is more comfortable _________ 40%.",
                translation: 'Ngược lại, tỷ lệ người thích đi ô tô vì nó thoải mái hơn là 40%.',
                explanation: 'Chủ ngữ của câu là "the percentage" (số ít), nên động từ "to be" phải chia là "is".',
                grammar_note: 'Sự hòa hợp giữa chủ ngữ và động từ: "the percentage of + Noun (số nhiều)" vẫn đi với động từ số ít.'
            },
            'q9': {
                correct_answer: 'D', // remained unchanged
                context: "To specify, after a small decrease from 300 to nearly 200 grams for the first 5 years, the amount of consumption in fish and chips _________ from 1975 to 1985.",
                translation: 'Cụ thể, sau một sự sụt giảm nhỏ từ 300 xuống gần 200 gram trong 5 năm đầu, lượng tiêu thụ cá và khoai tây chiên vẫn không thay đổi từ năm 1975 đến 1985.',
                explanation: 'Câu này đang mô tả một sự kiện đã xảy ra trong quá khứ (từ 1975 đến 1985), và "the amount of consumption" là chủ ngữ của hành động "remained", do đó cần một động từ chia ở thì quá khứ đơn, dạng chủ động.',
                grammar_note: 'Thì quá khứ đơn để miêu tả hành động trong khoảng thời gian cụ thể trong quá khứ.'
            },
            'q10': {
                correct_answer: 'B', // soared
                context: "Despite going up insignificantly from 20 to 30 grams for the first 5 years, the amount of consumption in Pizza _________ quickly during the remaining years and reached a peak of 180 grams.",
                translation: 'Mặc dù tăng nhẹ từ 20 lên 30 gram trong 5 năm đầu, lượng tiêu thụ Pizza đã tăng vọt nhanh chóng trong những năm còn lại và đạt đỉnh 180 gram.',
                explanation: 'Tương tự câu 9, câu này miêu tả hành động đã xảy ra và hoàn thành trong quá khứ ("reached a peak"), nên động từ chính cần chia ở thì quá khứ đơn.',
                grammar_note: 'Thì quá khứ đơn để miêu tả chuỗi hành động trong quá khứ.'
            },
            'q11': {
                correct_answer: 'used to be a chore',
                context: "Going shopping _________, but recently it has become a leisure activity.",
                translation: 'Đi mua sắm từng là một việc vặt, nhưng gần đây nó đã trở thành một hoạt động giải trí.',
                explanation: 'Cấu trúc "used to + V" (từng làm gì) để diễn tả thói quen hoặc trạng thái trong quá khứ không còn ở hiện tại.',
                grammar_note: 'Cấu trúc "used to + bare infinitive".'
            },
            'q12': {
                correct_answer: 'can find',
                context: "By contrast, shoppers nowadays _________ almost anything in the supermarket or shopping mall.",
                translation: 'Ngược lại, người mua sắm ngày nay có thể tìm thấy hầu hết mọi thứ trong siêu thị hoặc trung tâm mua sắm.',
                explanation: 'Động từ khuyết thiếu "can" (có thể) phải đi với động từ nguyên mẫu không "to".',
                grammar_note: 'Modal verbs + bare infinitive.'
            },
            'q13': {
                correct_answer: 'there are',
                context: "To sum up, _________ some services which must be provided by the government such as defense and social security.",
                translation: 'Tóm lại, có một số dịch vụ phải được chính phủ cung cấp như quốc phòng và an sinh xã hội.',
                explanation: 'Cấu trúc "There is/are" để giới thiệu sự tồn tại của một cái gì đó. "Services" là danh từ số nhiều, nên dùng "are".',
                grammar_note: 'Cấu trúc "There is/are".'
            },
            'q14': {
                correct_answer: 'is',
                context: "Social media _________ becoming increasingly popular amongst all age groups.",
                translation: 'Mạng xã hội đang ngày càng trở nên phổ biến trong mọi lứa tuổi.',
                explanation: '"Social media" thường được coi là danh từ số ít trong ngữ cảnh này, và câu đang diễn tả một xu hướng đang diễn ra ("becoming increasingly popular"), nên dùng thì hiện tại tiếp diễn.',
                grammar_note: 'Sự hòa hợp chủ ngữ-động từ: "Social media" thường đi với động từ số ít.'
            },
            'q15': {
                correct_answer: 'A', // follow
                context: "Many parents never let children _________ their passion, which makes children become tired with their unwanted job in the future.",
                translation: 'Nhiều bậc cha mẹ không bao giờ để con cái theo đuổi đam mê của chúng, điều này khiến trẻ em trở nên mệt mỏi với công việc không mong muốn của mình trong tương lai.',
                explanation: 'Cấu trúc "let + O + V (bare infinitive)" (để ai đó làm gì).',
                grammar_note: 'Cấu trúc với động từ "let".'
            },
            'q16': {
                correct_answer: 'A', // be
                context: "There are some strategies that can _________ used to encourage young people to keep abreast of the news.",
                translation: 'Có một số chiến lược có thể được sử dụng để khuyến khích những người trẻ tuổi cập nhật tin tức.',
                explanation: 'Sau động từ khuyết thiếu "can" và trước "used" (V3 trong bị động), cần một "be" để tạo thành cấu trúc bị động "can be used".',
                grammar_note: 'Cấu trúc bị động với động từ khuyết thiếu: Modal + be + V3/ed.'
            },
            'q17': {
                correct_answer: 'B', // inspired
                context: "It is important that employers keep _________ their workers by giving them encouragement frequently.",
                translation: 'Điều quan trọng là các nhà tuyển dụng phải giữ cho nhân viên của họ được truyền cảm hứng bằng cách thường xuyên động viên họ.',
                explanation: 'Cấu trúc "keep + O + V3/ed" (giữ cho ai đó ở trạng thái nào). "Workers" (người lao động) bị "truyền cảm hứng" (inspired) chứ không phải tự truyền cảm hứng ("inspiring").',
                grammar_note: 'Phân từ quá khứ (V3/ed) dùng làm tính từ chỉ kết quả của hành động, thường dùng với thể bị động.'
            },
            'q18': {
                correct_answer: 'D', // spent
                context: "Crime is an issue of increasing concern around the world, and more money than ever before is being _________ on the detection and punishment of criminal activity.",
                translation: 'Tội phạm là một vấn đề ngày càng đáng lo ngại trên khắp thế giới, và nhiều tiền hơn bao giờ hết đang được chi cho việc phát hiện và trừng phạt các hoạt động tội phạm.',
                explanation: 'Cấu trúc bị động của thì hiện tại tiếp diễn: "is being + V3/ed". "Money" (tiền) được "chi tiêu" ("spent"), không phải tự nó "chi tiêu".',
                grammar_note: 'Thì hiện tại tiếp diễn, thể bị động: S + is/am/are + being + V3/ed.'
            },
            'q19': {
                correct_answer: 'B', // suffering
                context: "In some countries an increasing number of people are _________ from health problems as a result of eating too much fast food.",
                translation: 'Ở một số quốc gia, ngày càng có nhiều người đang mắc các vấn đề sức khỏe do ăn quá nhiều thức ăn nhanh.',
                explanation: 'Cấu trúc "are + V-ing" để tạo thành thì hiện tại tiếp diễn, diễn tả hành động đang diễn ra. "Suffer from" là cụm động từ "chịu đựng, mắc phải".',
                grammar_note: 'Thì hiện tại tiếp diễn: S + is/am/are + V-ing.'
            },
            'q20': {
                correct_answer: 'A', // seem
                context: "From an economic point of view, higher tax might _________ an effective solution.",
                translation: 'Từ góc độ kinh tế, thuế cao hơn có vẻ là một giải pháp hiệu quả.',
                explanation: 'Sau động từ khuyết thiếu "might", động từ chính phải ở dạng nguyên mẫu không "to".',
                grammar_note: 'Modal verbs + bare infinitive.'
            },
            'q21': {
                correct_answer: 'B', // does not seem
                context: "In conclusion, imposing a higher tax on fast food _________ to be the only way to tackle the problem.",
                translation: 'Tóm lại, việc áp đặt thuế cao hơn đối với thức ăn nhanh dường như không phải là cách duy nhất để giải quyết vấn đề.',
                explanation: 'Chủ ngữ "imposing a higher tax on fast food" là một danh động từ (gerund phrase), được coi là số ít, nên động từ chính cần chia ở số ít và ở dạng phủ định đúng là "does not seem".',
                grammar_note: 'Danh động từ làm chủ ngữ luôn ở dạng số ít. Động từ "seem" có "to be" theo sau.'
            }
        };

        /**
         * Hàm xử lý khi người dùng chọn một tùy chọn.
         * @param {string} questionId - ID của câu hỏi (ví dụ: 'q1').
         * @param {string} selectedValue - Giá trị của tùy chọn được chọn.
         * @param {HTMLElement} clickedElement - Phần tử HTML (span) mà người dùng đã click.
         */
        function selectOption(questionId, selectedValue, clickedElement) {
            // Lấy input ẩn để lưu giá trị đã chọn
            const hiddenInput = document.getElementById(questionId);
            hiddenInput.value = selectedValue;

            // Xóa lớp 'selected-option' khỏi tất cả các tùy chọn khác của câu hỏi này
            const optionGroup = clickedElement.closest('.option-group');
            if (optionGroup) {
                const allOptions = optionGroup.querySelectorAll('.option-item');
                allOptions.forEach(option => {
                    option.classList.remove('selected-option', 'is-correct', 'is-incorrect');
                });
            }

            // Thêm lớp 'selected-option' vào tùy chọn đã click
            clickedElement.classList.add('selected-option');

            // Ẩn icon phản hồi cũ nếu có
            const feedbackIcon = document.getElementById(`icon${questionId.substring(1)}`);
            if (feedbackIcon) {
                feedbackIcon.style.display = 'none';
                feedbackIcon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
            }
        }

        /**
         * Gửi câu trả lời của người dùng, tính điểm, cung cấp phản hồi
         * và hiển thị lời giải chi tiết.
         */
        function submitAnswers() {
            let score = 0;
            const totalQuestions = Object.keys(questionsData).length;

            const solutionListDiv = document.querySelector('#detailedSolution .solution-list');
            solutionListDiv.innerHTML = ''; // Xóa các lời giải cũ
            document.getElementById('detailedSolution').style.display = 'block'; // Hiển thị phần lời giải

            // Lặp qua từng câu hỏi
            Object.keys(questionsData).forEach(qId => {
                const questionInfo = questionsData[qId];
                const hiddenInput = document.getElementById(qId); // Lấy input ẩn để lấy giá trị
                const feedbackIcon = document.getElementById(`icon${qId.substring(1)}`);
                const selectedOptionElement = document.querySelector(`#options-${qId} .option-item.selected-option`); // Lấy phần tử tùy chọn đang được chọn

                // Xóa các lớp phản hồi cũ trên tất cả các tùy chọn của câu hỏi này
                const allOptionsForQuestion = document.querySelectorAll(`#options-${qId} .option-item`);
                allOptionsForQuestion.forEach(option => {
                    option.classList.remove('is-correct', 'is-incorrect');
                });

                const userAnswer = hiddenInput.value.trim().toLowerCase();
                const correctAnswer = String(questionInfo.correct_answer).toLowerCase();

                let isCorrect = false;
                // For A/B/C/D questions, compare the selected letter. For others, compare the full value.
                if (['q6', 'q7', 'q8', 'q9', 'q10', 'q15', 'q16', 'q17', 'q18', 'q19', 'q20', 'q21'].includes(qId)) {
                    // Compare only the letter (A, B, C, D)
                    if (userAnswer.charAt(0).toUpperCase() === correctAnswer.charAt(0).toUpperCase()) {
                        isCorrect = true;
                        score++;
                        if (selectedOptionElement) {
                            selectedOptionElement.classList.add('is-correct');
                        }
                    } else {
                        if (selectedOptionElement) {
                            selectedOptionElement.classList.add('is-incorrect');
                        }
                        // Highlight the correct option if user chose incorrectly
                        const correctOptionElement = document.querySelector(`#options-${qId} .option-item[data-value="${questionInfo.correct_answer}"]`);
                        if (correctOptionElement) {
                            correctOptionElement.classList.add('is-correct');
                        }
                    }
                } else {
                    // For direct word/phrase selection
                    if (userAnswer === correctAnswer) {
                        isCorrect = true;
                        score++;
                        if (selectedOptionElement) {
                            selectedOptionElement.classList.add('is-correct');
                        }
                    } else {
                        if (selectedOptionElement) {
                            selectedOptionElement.classList.add('is-incorrect');
                        }
                        // Highlight the correct option if user chose incorrectly
                        const correctOptionElement = document.querySelector(`#options-${qId} .option-item[data-value="${questionInfo.correct_answer}"]`);
                        if (correctOptionElement) {
                            correctOptionElement.classList.add('is-correct');
                        }
                    }
                }


                // Hiển thị icon phản hồi
                if (feedbackIcon) {
                    feedbackIcon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
                    if (isCorrect) {
                        feedbackIcon.classList.add('fa-check-circle', 'text-success');
                    } else {
                        feedbackIcon.classList.add('fa-times-circle', 'text-danger');
                    }
                    feedbackIcon.style.display = 'inline-block';
                }

                // Thêm lời giải chi tiết
                const solutionItem = document.createElement('div');
                solutionItem.classList.add('solution-item');

                const questionNumber = qId.substring(1);
                const questionTextSolutionDiv = document.createElement('div');
                questionTextSolutionDiv.classList.add('question-text-solution');

                // Xây dựng câu hoàn chỉnh/cụm từ để hiển thị
                let fullSentenceHtml = questionInfo.context.replace(/_________/, `<span class="correct-answer-text">${
                    // For A/B/C/D questions, show the full correct option text, not just the letter
                    ['q6', 'q7', 'q8', 'q9', 'q10', 'q15', 'q16', 'q17', 'q18', 'q19', 'q20', 'q21'].includes(qId)
                        ? document.querySelector(`#options-${qId} .option-item[data-value="${questionInfo.correct_answer}"]`).textContent
                        : questionInfo.correct_answer
                }</span>`);
                
                // Nếu là câu hỏi trắc nghiệm A, B, C, D, hiển thị thêm đáp án chữ cái
                if (['q6', 'q7', 'q8', 'q9', 'q10', 'q15', 'q16', 'q17', 'q18', 'q19', 'q20', 'q21'].includes(qId)) {
                    fullSentenceHtml += ` (Đáp án: ${String(questionInfo.correct_answer).toUpperCase()})`;
                }
                questionTextSolutionDiv.innerHTML = `<strong>Câu hỏi:</strong> ${questionNumber}. ${fullSentenceHtml}`;
                solutionItem.appendChild(questionTextSolutionDiv);

                const grammarExplanationDiv = document.createElement('div');
                grammarExplanationDiv.classList.add('grammar-explanation');
                grammarExplanationDiv.innerHTML = `<strong>Giải thích:</strong> ${questionInfo.explanation}<br><em>${questionInfo.grammar_note}</em>`;
                solutionItem.appendChild(grammarExplanationDiv);

                const translationDiv = document.createElement('div');
                translationDiv.classList.add('translation');
                translationDiv.innerHTML = `<strong>Dịch:</strong> ${questionInfo.translation || 'Không có bản dịch.'}`;
                solutionItem.appendChild(translationDiv);

                solutionListDiv.appendChild(solutionItem);
            });

            // Hiển thị điểm số
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.textContent = `Bạn đã đạt ${score} / ${totalQuestions} điểm.`;

            // Áp dụng mã màu cho hiển thị điểm số dựa trên hiệu suất
            scoreDisplay.classList.remove('text-success', 'text-warning', 'text-danger');
            if (score === totalQuestions) {
                scoreDisplay.classList.add('text-success');
            } else if (score >= totalQuestions * 0.7) { // 70% hoặc hơn
                scoreDisplay.classList.add('text-warning');
            } else {
                scoreDisplay.classList.add('text-danger');
            }
            scoreDisplay.style.display = 'block'; // Hiển thị điểm số

            // Cuộn đến phần hiển thị điểm số
            scoreDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        /**
         * Đặt lại bài tập bằng cách xóa các trường nhập liệu, ẩn phản hồi, điểm số và lời giải.
         */
        function resetExercise() {
            const hiddenInputs = document.querySelectorAll('input[type="hidden"]');
            hiddenInputs.forEach(input => {
                input.value = ''; // Xóa giá trị input ẩn
            });

            const allOptions = document.querySelectorAll('.option-item');
            allOptions.forEach(option => {
                option.classList.remove('selected-option', 'is-correct', 'is-incorrect'); // Xóa các lớp phản hồi và chọn
            });

            const feedbackIcons = document.querySelectorAll('.feedback-icon');
            feedbackIcons.forEach(icon => {
                icon.classList.remove('fa-check-circle', 'fa-times-circle', 'text-success', 'text-danger');
                icon.style.display = 'none'; // Ẩn icon phản hồi
            });

            document.getElementById('scoreDisplay').textContent = ''; // Xóa văn bản điểm số
            document.getElementById('scoreDisplay').style.display = 'none'; // Ẩn hiển thị điểm số
            document.getElementById('detailedSolution').style.display = 'none'; // Ẩn phần lời giải
            document.querySelector('#detailedSolution .solution-list').innerHTML = ''; // Xóa danh sách lời giải
        }
    </script>
</body>
</html>
