<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài tập Ngữ pháp Tiếng Đức: Gia đình (Mở rộng) / Deutsch Grammatik Übungen: Familie (Erweitert)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            line-height: 1.7;
        }
        .container {
            max-width: 960px;
            margin-top: 25px;
            margin-bottom: 25px;
        }
        .card {
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border: none;
        }
        .card-header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            font-weight: 600;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
            padding: 1.25rem 1.5rem;
            border-bottom: none;
        }
        .card-header h1, .card-header h2 {
            margin-bottom: 0;
            font-size: 1.6rem; /* Adjusted for longer title */
        }
        .card-body {
            padding: 1.5rem; /* Adjusted padding */
        }
        .instructions {
            background-color: #e9f5ff;
            padding: 1.25rem;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 5px solid #007bff;
            font-size: 0.95rem;
        }
        .instructions p {
            margin-bottom: 0.5rem;
        }
        .question-group-title {
            font-size: 1.4rem; /* Adjusted */
            font-weight: 500;
            color: #0056b3;
            margin-top: 2rem; /* Adjusted */
            margin-bottom: 1.25rem; /* Adjusted */
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #007bff;
        }
        .question-block {
            margin-bottom: 20px; /* Adjusted */
            padding: 15px; /* Adjusted */
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fff;
            transition: box-shadow 0.3s ease;
        }
        .question-block:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        .form-label {
            font-weight: 500;
            margin-bottom: 0.6rem; /* Adjusted */
            display: block;
        }
        .form-control, .form-select {
            border-radius: 6px;
            border-color: #ced4da;
            padding: 0.45rem 0.9rem; /* Adjusted */
            font-size: 0.95rem; /* Ensure consistent font size */
        }
        .form-control:focus, .form-select:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
        }
        .feedback-icon {
            font-size: 1.2rem; /* Adjusted */
            margin-left: 8px; /* Adjusted */
            vertical-align: middle;
        }
        .correct-answer-text {
            font-weight: bold;
            color: #198754;
        }
        .solution-details {
            margin-top: 12px; /* Adjusted */
            padding: 12px; /* Adjusted */
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.88rem; /* Adjusted */
        }
        .solution-details p {
            margin-bottom: 0.35rem; /* Adjusted */
        }
        .solution-details strong {
            color: #0056b3;
        }
        .btn-check-answers {
            background-color: #28a745;
            border-color: #28a745;
            font-size: 1.1rem; /* Adjusted */
            padding: 0.65rem 1.8rem; /* Adjusted */
            font-weight: 500;
            border-radius: 8px;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .btn-check-answers:hover {
            background-color: #218838;
            border-color: #1e7e34;
        }
        .score-display {
            font-size: 1.25rem; /* Adjusted */
            font-weight: bold;
            margin-top: 25px; /* Adjusted */
            padding: 18px; /* Adjusted */
            background-color: #d1e7dd;
            border: 1px solid #badbcc;
            border-radius: 8px;
            text-align: center;
            color: #0f5132;
        }
        .is-valid {
            border-color: #198754 !important;
        }
        .is-invalid {
            border-color: #dc3545 !important;
        }
        .input-group-text.feedback-icon-container {
            background-color: transparent;
            border-left: 0;
            padding-right: 0.65rem; /* Adjusted */
        }
        .form-control.is-valid, .form-select.is-valid,
        .form-control.is-invalid, .form-select.is-invalid {
            padding-right: calc(1.5em + 0.75rem);
            background-image: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header text-center">
                <h2>Bài tập Ngữ pháp Tiếng Đức: Gia đình (Mở rộng)</h2>
                <h2 style="font-size: 1.15rem; font-weight: 400;">Deutsch Grammatik Übungen: Familie (Erweitert)</h2>
            </div>
            <div class="card-body">
                <div class="instructions">
                    <p><strong>Hướng dẫn (Anleitung):</strong></p>
                    <p>Hoàn thành các câu sau bằng cách điền vào chỗ trống hoặc chọn đáp án đúng. Sau khi hoàn thành, nhấn nút "Kiểm tra" ở cuối trang để xem kết quả và giải thích chi tiết.</p>
                    <p><em>Vervollständigen Sie die folgenden Sätze, indem Sie die Lücken ausfüllen oder die richtige Antwort auswählen. Klicken Sie nach Abschluss auf die Schaltfläche "Überprüfen" am Ende der Seite, um Ihre Ergebnisse und detaillierte Erklärungen anzuzeigen.</em></p>
                </div>

                <form id="grammar-form">
                    <h3 class="question-group-title">Phần 1: Đại từ sở hữu (Possessivartikel)</h3>
                    <div class="question-block" id="q1-block">
                        <label for="q1-input" class="form-label">1. Das ist ______ Bruder. Er heißt Leon. (<em>Đại từ cho "ich"</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q1-input" name="q1" aria-describedby="q1-feedback">
                            <span class="input-group-text feedback-icon-container" id="q1-feedback-container"><span class="feedback-icon" id="q1-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q1-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q2-block">
                        <label for="q2-input" class="form-label">2. Anna, ist das ______ Tochter? (<em>Đại từ cho "du"</em>)</label>
                         <div class="input-group">
                            <input type="text" class="form-control" id="q2-input" name="q2" aria-describedby="q2-feedback">
                            <span class="input-group-text feedback-icon-container" id="q2-feedback-container"><span class="feedback-icon" id="q2-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q2-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q3-block">
                        <label for="q3-input" class="form-label">3. Herr Weber, das sind ______ Eltern. (<em>Đại từ cho "Sie" - trang trọng</em>)</label>
                         <div class="input-group">
                            <input type="text" class="form-control" id="q3-input" name="q3" aria-describedby="q3-feedback">
                            <span class="input-group-text feedback-icon-container" id="q3-feedback-container"><span class="feedback-icon" id="q3-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q3-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q4-block">
                        <label for="q4-input" class="form-label">4. Maria hat einen Hund. ______ Hund ist sehr klein und süß. (<em>Đại từ cho "Maria" - sie</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q4-input" name="q4" aria-describedby="q4-feedback">
                            <span class="input-group-text feedback-icon-container" id="q4-feedback-container"><span class="feedback-icon" id="q4-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q4-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q5-block">
                        <label for="q5-input" class="form-label">5. Wir lieben ______ Katze. Sie heißt Mimi. (<em>Đại từ cho "wir"</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q5-input" name="q5" aria-describedby="q5-feedback">
                            <span class="input-group-text feedback-icon-container" id="q5-feedback-container"><span class="feedback-icon" id="q5-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q5-solution" style="display:none;"></div>
                    </div>
                     <div class="question-block" id="q6-block">
                        <label for="q6-input" class="form-label">6. Kinder, wo ist ______ Ball? (<em>Đại từ cho "ihr" - các bạn</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q6-input" name="q6" aria-describedby="q6-feedback">
                            <span class="input-group-text feedback-icon-container" id="q6-feedback-container"><span class="feedback-icon" id="q6-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q6-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q7-block">
                        <label for="q7-input" class="form-label">7. Das Auto gehört Paul. Das ist ______ Auto. (<em>Đại từ cho "Paul" - er</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q7-input" name="q7" aria-describedby="q7-feedback">
                            <span class="input-group-text feedback-icon-container" id="q7-feedback-container"><span class="feedback-icon" id="q7-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q7-solution" style="display:none;"></div>
                    </div>

                    <h3 class="question-group-title">Phần 2: Chia động từ "sein" và "haben"</h3>
                    <div class="question-block" id="q8-block">
                        <label for="q8-select" class="form-label">8. Ich ______ eine Schwester und zwei Brüder.</label>
                        <div class="input-group">
                            <select class="form-select" id="q8-select" name="q8" aria-describedby="q8-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="habe">habe</option>
                                <option value="hast">hast</option>
                                <option value="hat">hat</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q8-feedback-container"><span class="feedback-icon" id="q8-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q8-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q9-block">
                        <label for="q9-select" class="form-label">9. Du ______ mein bester Freund.</label>
                        <div class="input-group">
                            <select class="form-select" id="q9-select" name="q9" aria-describedby="q9-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="bin">bin</option>
                                <option value="bist">bist</option>
                                <option value="ist">ist</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q9-feedback-container"><span class="feedback-icon" id="q9-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q9-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q10-block">
                        <label for="q10-select" class="form-label">10. Meine Großeltern ______ sehr alt, aber fit.</label>
                        <div class="input-group">
                            <select class="form-select" id="q10-select" name="q10" aria-describedby="q10-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="ist">ist</option>
                                <option value="sind">sind</option>
                                <option value="seid">seid</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q10-feedback-container"><span class="feedback-icon" id="q10-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q10-solution" style="display:none;"></div>
                    </div>
                     <div class="question-block" id="q11-block">
                        <label for="q11-select" class="form-label">11. ______ ihr Geschwister?</label>
                        <div class="input-group">
                            <select class="form-select" id="q11-select" name="q11" aria-describedby="q11-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="Hat">Hat</option>
                                <option value="Habt">Habt</option>
                                <option value="Haben">Haben</option>
                                <option value="Seid">Seid</option>
                                <option value="Sind">Sind</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q11-feedback-container"><span class="feedback-icon" id="q11-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q11-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q12-block">
                        <label for="q12-select" class="form-label">12. Peter ______ einen neuen Computer.</label>
                        <div class="input-group">
                            <select class="form-select" id="q12-select" name="q12" aria-describedby="q12-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="habe">habe</option>
                                <option value="hast">hast</option>
                                <option value="hat">hat</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q12-feedback-container"><span class="feedback-icon" id="q12-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q12-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q13-block">
                        <label for="q13-select" class="form-label">13. Wir ______ Studenten aus Vietnam.</label>
                        <div class="input-group">
                            <select class="form-select" id="q13-select" name="q13" aria-describedby="q13-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="bin">bin</option>
                                <option value="sind">sind</option>
                                <option value="seid">seid</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q13-feedback-container"><span class="feedback-icon" id="q13-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q13-solution" style="display:none;"></div>
                    </div>

                    <h3 class="question-group-title">Phần 3: Chia động từ thường</h3>
                    <div class="question-block" id="q14-block">
                        <label for="q14-input" class="form-label">14. Meine Familie ______ in einem kleinen Dorf. (<em>Động từ: leben</em>)</label>
                         <div class="input-group">
                            <input type="text" class="form-control" id="q14-input" name="q14" aria-describedby="q14-feedback">
                            <span class="input-group-text feedback-icon-container" id="q14-feedback-container"><span class="feedback-icon" id="q14-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q14-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q15-block">
                        <label for="q15-input" class="form-label">15. Wie ______ dein Vater mit Vornamen? (<em>Động từ: heißen</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q15-input" name="q15" aria-describedby="q15-feedback">
                            <span class="input-group-text feedback-icon-container" id="q15-feedback-container"><span class="feedback-icon" id="q15-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q15-solution" style="display:none;"></div>
                    </div>
                     <div class="question-block" id="q16-block">
                        <label for="q16-input" class="form-label">16. Wir ______ zu Hause oft Deutsch miteinander. (<em>Động từ: sprechen</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q16-input" name="q16" aria-describedby="q16-feedback">
                            <span class="input-group-text feedback-icon-container" id="q16-feedback-container"><span class="feedback-icon" id="q16-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q16-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q17-block">
                        <label for="q17-input" class="form-label">17. Wo ______ du? Ich ______ in Berlin. (<em>Động từ: wohnen, 2 chỗ trống</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control me-2" id="q17-input-1" name="q17_1" placeholder="Chỗ trống 1" aria-describedby="q17-feedback">
                            <input type="text" class="form-control" id="q17-input-2" name="q17_2" placeholder="Chỗ trống 2" aria-describedby="q17-feedback">
                            <span class="input-group-text feedback-icon-container" id="q17-feedback-container"><span class="feedback-icon" id="q17-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q17-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q18-block">
                        <label for="q18-input" class="form-label">18. Meine Tante ______ aus Spanien. (<em>Động từ: kommen</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q18-input" name="q18" aria-describedby="q18-feedback">
                            <span class="input-group-text feedback-icon-container" id="q18-feedback-container"><span class="feedback-icon" id="q18-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q18-solution" style="display:none;"></div>
                    </div>
                     <div class="question-block" id="q19-block">
                        <label for="q19-input" class="form-label">19. Was ______ ihr gern in der Freizeit? (<em>Động từ: machen</em>)</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="q19-input" name="q19" aria-describedby="q19-feedback">
                            <span class="input-group-text feedback-icon-container" id="q19-feedback-container"><span class="feedback-icon" id="q19-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q19-solution" style="display:none;"></div>
                    </div>


                    <h3 class="question-group-title">Phần 4: W-Fragen (Câu hỏi với từ để hỏi)</h3>
                    <div class="question-block" id="q20-block">
                        <label for="q20-select" class="form-label">20. ______ heißt deine Mutter?</label>
                        <div class="input-group">
                            <select class="form-select" id="q20-select" name="q20" aria-describedby="q20-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="Wie">Wie</option>
                                <option value="Wo">Wo</option>
                                <option value="Wer">Wer</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q20-feedback-container"><span class="feedback-icon" id="q20-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q20-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q21-block">
                        <label for="q21-select" class="form-label">21. ______ wohnen deine Großeltern?</label>
                        <div class="input-group">
                             <select class="form-select" id="q21-select" name="q21" aria-describedby="q21-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="Was">Was</option>
                                <option value="Woher">Woher</option>
                                <option value="Wo">Wo</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q21-feedback-container"><span class="feedback-icon" id="q21-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q21-solution" style="display:none;"></div>
                    </div>
                    <div class="question-block" id="q22-block">
                        <label for="q22-select" class="form-label">22. ______ ist das? - Das ist mein Onkel.</label>
                        <div class="input-group">
                             <select class="form-select" id="q22-select" name="q22" aria-describedby="q22-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="Wie alt">Wie alt</option>
                                <option value="Wer">Wer</option>
                                <option value="Was">Was</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q22-feedback-container"><span class="feedback-icon" id="q22-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q22-solution" style="display:none;"></div>
                    </div>
                     <div class="question-block" id="q23-block">
                        <label for="q23-select" class="form-label">23. ______ kommen deine Cousins?</label>
                        <div class="input-group">
                             <select class="form-select" id="q23-select" name="q23" aria-describedby="q23-feedback">
                                <option value="">-- Chọn / Auswählen --</option>
                                <option value="Wo">Wo</option>
                                <option value="Woher">Woher</option>
                                <option value="Wie">Wie</option>
                            </select>
                            <span class="input-group-text feedback-icon-container" id="q23-feedback-container"><span class="feedback-icon" id="q23-feedback"></span></span>
                        </div>
                        <div class="solution-details" id="q23-solution" style="display:none;"></div>
                    </div>


                    <div class="text-center mt-5">
                        <button type="button" class="btn btn-check-answers" onclick="checkAnswers()">Kiểm tra / Überprüfen</button>
                    </div>
                </form>

                <div id="score-display" class="score-display" style="display:none;"></div>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            // Phần 1: Đại từ sở hữu
            { id: 'q1', inputId: 'q1-input', type: 'input', correctAnswer: 'mein', explanation: { grammar: '"Bruder" (m) -> mein.', fullSentenceDE: 'Das ist <strong>mein</strong> Bruder. Er heißt Leon.', fullSentenceVI: 'Đây là anh trai <strong>của tôi</strong>. Anh ấy tên là Leon.'}},
            { id: 'q2', inputId: 'q2-input', type: 'input', correctAnswer: 'deine', explanation: { grammar: '"Tochter" (f) -> deine.', fullSentenceDE: 'Anna, ist das <strong>deine</strong> Tochter?', fullSentenceVI: 'Anna, đây có phải là con gái <strong>của bạn</strong> không?'}},
            { id: 'q3', inputId: 'q3-input', type: 'input', correctAnswer: 'Ihre', explanation: { grammar: '"Eltern" (pl, trang trọng) -> Ihre.', fullSentenceDE: 'Herr Weber, das sind <strong>Ihre</strong> Eltern.', fullSentenceVI: 'Thưa ông Weber, đây là bố mẹ <strong>của Ngài</strong>.'}},
            { id: 'q4', inputId: 'q4-input', type: 'input', correctAnswer: 'ihr', explanation: { grammar: '"Hund" (m), Maria (sie) -> ihr Hund.', fullSentenceDE: 'Maria hat einen Hund. <strong>Ihr</strong> Hund ist sehr klein und süß.', fullSentenceVI: 'Maria có một con chó. Con chó <strong>của cô ấy</strong> rất nhỏ và dễ thương.'}},
            { id: 'q5', inputId: 'q5-input', type: 'input', correctAnswer: 'unsere', explanation: { grammar: '"Katze" (f), wir -> unsere Katze.', fullSentenceDE: 'Wir lieben <strong>unsere</strong> Katze. Sie heißt Mimi.', fullSentenceVI: 'Chúng tôi yêu con mèo <strong>của chúng tôi</strong>. Nó tên là Mimi.'}},
            { id: 'q6', inputId: 'q6-input', type: 'input', correctAnswer: 'euer', explanation: { grammar: '"Ball" (m), ihr (các bạn) -> euer Ball.', fullSentenceDE: 'Kinder, wo ist <strong>euer</strong> Ball?', fullSentenceVI: 'Các con, quả bóng <strong>của các con</strong> đâu rồi?'}},
            { id: 'q7', inputId: 'q7-input', type: 'input', correctAnswer: 'sein', explanation: { grammar: '"Auto" (n), Paul (er) -> sein Auto.', fullSentenceDE: 'Das Auto gehört Paul. Das ist <strong>sein</strong> Auto.', fullSentenceVI: 'Chiếc ô tô thuộc về Paul. Đây là ô tô <strong>của anh ấy</strong>.'}},
            
            // Phần 2: sein & haben
            { id: 'q8', inputId: 'q8-select', type: 'select', correctAnswer: 'habe', explanation: { grammar: 'ich -> habe.', fullSentenceDE: 'Ich <strong>habe</strong> eine Schwester und zwei Brüder.', fullSentenceVI: 'Tôi <strong>có</strong> một chị gái và hai anh trai.'}},
            { id: 'q9', inputId: 'q9-select', type: 'select', correctAnswer: 'bist', explanation: { grammar: 'du -> bist.', fullSentenceDE: 'Du <strong>bist</strong> mein bester Freund.', fullSentenceVI: 'Bạn <strong>là</strong> người bạn thân nhất của tôi.'}},
            { id: 'q10', inputId: 'q10-select', type: 'select', correctAnswer: 'sind', explanation: { grammar: 'Meine Großeltern (pl, sie) -> sind.', fullSentenceDE: 'Meine Großeltern <strong>sind</strong> sehr alt, aber fit.', fullSentenceVI: 'Ông bà tôi <strong>rất</strong> già nhưng khỏe mạnh.'}},
            { id: 'q11', inputId: 'q11-select', type: 'select', correctAnswer: 'Seid', explanation: { grammar: 'ihr -> seid (sein).', fullSentenceDE: '<strong>Seid</strong> ihr Geschwister?', fullSentenceVI: 'Các bạn <strong>có phải là</strong> anh chị em (ruột) không?'}},
            { id: 'q12', inputId: 'q12-select', type: 'select', correctAnswer: 'hat', explanation: { grammar: 'Peter (er) -> hat.', fullSentenceDE: 'Peter <strong>hat</strong> einen neuen Computer.', fullSentenceVI: 'Peter <strong>có</strong> một chiếc máy tính mới.'}},
            { id: 'q13', inputId: 'q13-select', type: 'select', correctAnswer: 'sind', explanation: { grammar: 'Wir -> sind.', fullSentenceDE: 'Wir <strong>sind</strong> Studenten aus Vietnam.', fullSentenceVI: 'Chúng tôi <strong>là</strong> sinh viên đến từ Việt Nam.'}},

            // Phần 3: Động từ thường
            { id: 'q14', inputId: 'q14-input', type: 'input', correctAnswer: 'lebt', explanation: { grammar: 'Meine Familie (sie, sg) -> lebt.', fullSentenceDE: 'Meine Familie <strong>lebt</strong> in einem kleinen Dorf.', fullSentenceVI: 'Gia đình tôi <strong>sống</strong> ở một ngôi làng nhỏ.'}},
            { id: 'q15', inputId: 'q15-input', type: 'input', correctAnswer: 'heißt', explanation: { grammar: 'dein Vater (er) -> heißt.', fullSentenceDE: 'Wie <strong>heißt</strong> dein Vater mit Vornamen?', fullSentenceVI: 'Bố của bạn <strong>tên</strong> (tên riêng) là gì?'}},
            { id: 'q16', inputId: 'q16-input', type: 'input', correctAnswer: 'sprechen', explanation: { grammar: 'Wir -> sprechen.', fullSentenceDE: 'Wir <strong>sprechen</strong> zu Hause oft Deutsch miteinander.', fullSentenceVI: 'Ở nhà chúng tôi thường <strong>nói</strong> tiếng Đức với nhau.'}},
            { 
                id: 'q17', 
                type: 'multi-input', 
                inputIds: ['q17-input-1', 'q17-input-2'], 
                correctAnswers: ['wohnst', 'wohne'], 
                explanation: { 
                    grammar: 'Câu 1: du -> wohnst. Câu 2: ich -> wohne.', 
                    fullSentenceDE: 'Wo <strong>wohnst</strong> du? Ich <strong>wohne</strong> in Berlin.', 
                    fullSentenceVI: 'Bạn <strong>sống</strong> ở đâu? Tôi <strong>sống</strong> ở Berlin.'
                }
            },
            { id: 'q18', inputId: 'q18-input', type: 'input', correctAnswer: 'kommt', explanation: { grammar: 'Meine Tante (sie, sg) -> kommt.', fullSentenceDE: 'Meine Tante <strong>kommt</strong> aus Spanien.', fullSentenceVI: 'Dì/cô tôi <strong>đến từ</strong> Tây Ban Nha.'}},
            { id: 'q19', inputId: 'q19-input', type: 'input', correctAnswer: 'macht', explanation: { grammar: 'ihr -> macht.', fullSentenceDE: 'Was <strong>macht</strong> ihr gern in der Freizeit?', fullSentenceVI: 'Các bạn thích <strong>làm</strong> gì vào thời gian rảnh?'}},

            // Phần 4: W-Fragen
            { id: 'q20', inputId: 'q20-select', type: 'select', correctAnswer: 'Wie', explanation: { grammar: 'Hỏi tên -> Wie heißt...?', fullSentenceDE: '<strong>Wie</strong> heißt deine Mutter?', fullSentenceVI: 'Mẹ bạn tên là <strong>gì</strong>?'}},
            { id: 'q21', inputId: 'q21-select', type: 'select', correctAnswer: 'Wo', explanation: { grammar: 'Hỏi nơi chốn (ở đâu) -> Wo wohnen...?', fullSentenceDE: '<strong>Wo</strong> wohnen deine Großeltern?', fullSentenceVI: 'Ông bà bạn sống ở <strong>đâu</strong>?'}},
            { id: 'q22', inputId: 'q22-select', type: 'select', correctAnswer: 'Wer', explanation: { grammar: 'Hỏi người -> Wer ist das?', fullSentenceDE: '<strong>Wer</strong> ist das? - Das ist mein Onkel.', fullSentenceVI: '<strong>Ai</strong> đây? - Đây là chú/cậu/bác tôi.'}},
            { id: 'q23', inputId: 'q23-select', type: 'select', correctAnswer: 'Woher', explanation: { grammar: 'Hỏi nguồn gốc (từ đâu) -> Woher kommen...?', fullSentenceDE: '<strong>Woher</strong> kommen deine Cousins?', fullSentenceVI: 'Anh em họ của bạn đến từ <strong>đâu</strong>?'}}
        ];

        function checkAnswers() {
            let score = 0;
            questions.forEach(q => {
                const feedbackElement = document.getElementById(q.id + '-feedback');
                const solutionElement = document.getElementById(q.id + '-solution');
                let isCorrect = false;

                if (q.type === 'input' || q.type === 'select') {
                    const inputElement = document.getElementById(q.inputId);
                    const userAnswer = inputElement.value.trim().toLowerCase();
                    inputElement.classList.remove('is-valid', 'is-invalid');
                    if (userAnswer === q.correctAnswer.toLowerCase()) {
                        isCorrect = true;
                        inputElement.classList.add('is-valid');
                    } else {
                        inputElement.classList.add('is-invalid');
                    }
                } else if (q.type === 'multi-input') {
                    let allMultiCorrect = true;
                    q.inputIds.forEach((inputId, index) => {
                        const inputElement = document.getElementById(inputId);
                        const userAnswer = inputElement.value.trim().toLowerCase();
                        inputElement.classList.remove('is-valid', 'is-invalid');
                        if (userAnswer === q.correctAnswers[index].toLowerCase()) {
                            inputElement.classList.add('is-valid');
                        } else {
                            allMultiCorrect = false;
                            inputElement.classList.add('is-invalid');
                        }
                    });
                    isCorrect = allMultiCorrect;
                }
                
                if (isCorrect) {
                    score++;
                    feedbackElement.textContent = '✅';
                    feedbackElement.style.color = '#198754'; 
                } else {
                    feedbackElement.textContent = '❌';
                    feedbackElement.style.color = '#dc3545'; 
                }

                let solutionHTML = `
                    <p><strong>Đáp án đúng (Richtige Antwort):</strong> <span class="correct-answer-text">${q.type === 'multi-input' ? q.correctAnswers.join(', ') : q.correctAnswer}</span></p>
                    <p><strong>Giải thích (Erklärung):</strong> ${q.explanation.grammar}</p>
                    <p><strong>Câu hoàn chỉnh (Vollständiger Satz):</strong> ${q.explanation.fullSentenceDE}</p>
                    <p><strong>Dịch nghĩa (Übersetzung):</strong> ${q.explanation.fullSentenceVI}</p>
                `;
                solutionElement.innerHTML = solutionHTML;
                solutionElement.style.display = 'block';
            });

            const scoreDisplay = document.getElementById('score-display');
            scoreDisplay.innerHTML = `Bạn đạt ${score}/${questions.length} điểm. / Sie haben ${score}/${questions.length} Punkte erreicht.`;
            scoreDisplay.style.display = 'block';
            scoreDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
